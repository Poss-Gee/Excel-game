<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Game for My Love ❤️</title>
    <style>
        /* Theme Variables */
        :root {
            /* Default Theme (Dark) */
            --bg-primary: #1a202c;
            --bg-secondary: #2d3748;
            --bg-card: #4a5568;
            --text-primary: #ffffff;
            --text-secondary: #e2e8f0;
            --accent-color: #daff0a;
            --card-border: none;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Light Theme */
        [data-theme="light"] {
            --bg-primary: #f7fafc;
            --bg-secondary: #edf2f7;
            --bg-card: #ffffff;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --accent-color: #3182ce;
            --card-border: 1px solid #e2e8f0;
            --card-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        /* Neon Theme */
        [data-theme="neon"] {
            --bg-primary: #000000;
            --bg-secondary: #1a1a1a;
            --bg-card: #2d2d2d;
            --text-primary: #00ff00;
            --text-secondary: #00ffaa;
            --accent-color: #ff00ff;
            --card-border: 1px solid #00ff00;
            --card-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        /* Base styles with theme variables */
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .header {
            background-color: var(--bg-secondary);
            border-bottom: var(--card-border);
        }

        .card {
            background-color: var(--bg-card);
            border: var(--card-border);
            box-shadow: var(--card-shadow);
        }

        .settings-section {
            background-color: var(--bg-secondary);
            border: var(--card-border);
            box-shadow: var(--card-shadow);
        }

        .setting-item {
            background-color: var(--bg-card);
            border: var(--card-border);
        }

        .settings-title {
            color: var(--accent-color);
        }

        .settings-select {
            background-color: var(--bg-card);
            color: var(--text-primary);
            border: 2px solid var(--accent-color);
        }

        .settings-select option {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .button {
            background-color: var(--accent-color);
            color: var(--bg-primary);
        }

        .modal-content {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: var(--card-border);
            box-shadow: var(--card-shadow);
        }

        .achievement-card {
            background-color: var(--bg-card);
            border: var(--card-border);
            box-shadow: var(--card-shadow);
        }

        .progress-bar {
            background-color: var(--accent-color);
        }

        /* Additional theme-specific styles */
        [data-theme="neon"] .card {
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.2);
        }

        [data-theme="neon"] .button:hover {
            box-shadow: 0 0 10px var(--accent-color);
        }

        [data-theme="light"] .card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Theme Selector Styles */
        .theme-preview {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-preview.default {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
        }

        .theme-preview.light {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-color: #cbd5e0;
        }

        .theme-preview.neon {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            border: 2px solid #00ff00;
            box-shadow: 0 0 5px #00ff00;
        }

        .theme-preview.active {
            transform: scale(1.2);
            border-color: var(--accent-color);
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            background-color: #1a202c;
            color: white;
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }
        .app-container {
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #2d3748;
            padding: 10px;
            text-align: center;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .header h1 {
            margin: 0;
            font-size: 20px;
            flex-grow: 1;
            text-align: center;
        }
        .main-content {
            margin-top: 50px;
            padding-bottom: 70px;
            width: 100%;
            max-width: 600px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            height: calc(100vh - 120px);
        }
        .menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .level-select {
            display: none;
            padding: 20px;
        }
        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .level-card {
            background: #2d3748;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            position: relative;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .level-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .level-card:not(.locked):hover {
            transform: scale(1.05);
            background-color: #4a5568;
        }
        .level-card .level-number {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .level-card .level-stars {
            color: #ffd700;
            font-size: 16px;
        }
        .level-card .level-size {
            font-size: 12px;
            color: #a0aec0;
            margin-top: 5px;
        }
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #2d3748;
            padding: 8px 4px;
            display: flex;
            justify-content: space-around;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #a0aec0;
            text-decoration: none;
            font-size: 11px;
            transition: all 0.3s ease;
            padding: 6px 12px;
            border-radius: 12px;
            min-width: 60px;
            position: relative;
            background: transparent;
            border: none;
            cursor: pointer;
        }
        .nav-item i {
            font-size: 18px;
            margin-bottom: 4px;
            transition: all 0.3s ease;
        }
        .nav-item span {
            font-weight: 500;
            opacity: 0.8;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .nav-item:hover {
            color: #daff0a;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        .nav-item:hover i {
            transform: scale(1.1);
        }
        .nav-item.active {
            color: #daff0a;
            background: rgba(218, 255, 10, 0.1);
        }
        .nav-item.active i {
            transform: scale(1.1);
        }
        .nav-item.active span {
            opacity: 1;
        }
        .nav-item .notification-dot {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            background: #ff4757;
            border-radius: 50%;
            display: none;
            animation: pulse 2s infinite;
        }
        .nav-item.has-notification .notification-dot {
            display: block;
        }
        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7);
            }
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 6px rgba(255, 71, 87, 0);
            }
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(255, 71, 87, 0);
            }
        }
        @media (max-height: 600px) {
            .bottom-nav {
                padding: 4px 2px;
            }
            .nav-item {
                padding: 4px 8px;
                font-size: 10px;
                min-width: 50px;
            }
            .nav-item i {
                font-size: 16px;
                margin-bottom: 2px;
            }
        }
        @media (max-width: 360px) {
            .nav-item {
                padding: 4px 6px;
                min-width: 45px;
            }
            .nav-item span {
                font-size: 9px;
            }
        }
        .modal {
            background-color: rgba(0, 0, 0, 0.9);
        }
        .modal-content {
            background-color: #2d3748;
            border-radius: 20px;
            max-width: 90%;
            width: 400px;
        }
        .grid {
            display: grid;
            gap: 8px;
            margin: 10px auto;
            width: 100%;
            max-width: 450px;
            padding: 5px;
        }
        .card {
            width: 100%;
            aspect-ratio: 1;
            background-color: #4a5568;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            background-size: cover;
            background-position: center;
            transition: transform 0.3s ease-in-out;
            position: relative;
            overflow: hidden;
        }
        .card.error::after {
            content: "❌";
            position: absolute;
            font-size: 2em;
        }
        .hidden {
            background-image: url('back.jpg');
            background-color: #2d3748;
        }
        .revealed {
            transform: rotateY(180deg);
        }
        .menu {
            text-align: center;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 25px;
            border: none;
            background-color: #daff0a;
            color: #1a202c;
            transition: transform 0.2s, background-color 0.2s;
        }
        button:hover {
            transform: scale(1.05);
            background-color: #c8eb09;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .game-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin: 8px 0;
            padding: 0 10px;
        }
        .game-controls button {
            padding: 8px 12px;
            font-size: 14px;
            min-width: auto;
        }
        .timer {
            margin-top: 10px;
            font-size: 18px;
            display: none;
            padding: 5px 15px;
            background-color: #2d3748;
            border-radius: 15px;
        }
        .timer.blink {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            50% { color: #ff4444; }
        }
        .progress {
            margin-top: 10px;
            font-size: 18px;
            background-color: #2d3748;
            padding: 10px 20px;
            border-radius: 15px;
        }
        .scores {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 400px;
            margin: 20px auto;
            background-color: #2d3748;
            padding: 15px;
            border-radius: 15px;
        }
        .scores div {
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .current-player {
            color: #daff0a;
            font-weight: bold;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #2d3748;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            color: white;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .modal-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        .coin-shop {
            margin: 20px 0;
            padding: 20px;
            background-color: #4a5568;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .hearts-container {
            position: fixed;
            pointer-events: none;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .heart {
            position: absolute;
            font-size: 30px;
            animation: float 1s ease-out forwards;
        }
        @keyframes float {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }
        .final-message {
            display: none;
            padding: 20px;
            margin-top: 20px;
            border-radius: 15px;
            background-color: #4a5568;
            text-align: center;
            animation: glow 2s infinite alternate;
        }
        @keyframes glow {
            from {
                box-shadow: 0 0 10px #ff69b4;
            }
            to {
                box-shadow: 0 0 20px #ff69b4, 0 0 30px #ff1493;
            }
        }
        .name-input {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        .name-input input {
            padding: 10px;
            border-radius: 10px;
            border: none;
            font-size: 16px;
        }
        .love-message {
            font-size: 18px;
            line-height: 1.6;
            color: #ffb6c1;
            margin-top: 20px;
            display: none;
        }
        .power-ups {
            display: flex;
            gap: 8px;
            margin: 8px 0;
            justify-content: center;
            flex-wrap: wrap;
            padding: 0 10px;
        }
        .power-up {
            padding: 8px;
            border-radius: 8px;
            background: #4a5568;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            min-width: 70px;
        }
        .power-up:hover {
            transform: scale(1.05);
        }
        .power-up.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .power-up-icon {
            font-size: 20px;
        }
        .power-up-count {
            font-size: 14px;
            color: #daff0a;
        }
        .achievements-panel {
            position: fixed;
            right: 20px;
            top: 20px;
            background: #2d3748;
            padding: 15px;
            border-radius: 15px;
            max-width: 300px;
            display: none;
        }
        .achievement {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background: #4a5568;
            border-radius: 10px;
            opacity: 0.5;
        }
        .achievement.unlocked {
            opacity: 1;
            animation: achievementUnlock 0.5s ease-out;
        }
        .achievement-icon {
            font-size: 24px;
        }
        @keyframes achievementUnlock {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .achievement-notification {
            position: fixed;
            top: 20px;
            right: -300px;
            background: #daff0a;
            color: #1a202c;
            padding: 15px;
            border-radius: 10px;
            animation: slideIn 0.5s forwards;
            z-index: 1000;
        }
        @keyframes slideIn {
            to { right: 20px; }
        }
        .theme-selector {
            position: fixed;
            left: 20px;
            top: 20px;
            background: #2d3748;
            padding: 15px;
            border-radius: 15px;
            z-index: 100;
        }
        .theme-option {
            margin: 5px 0;
            padding: 5px;
            cursor: pointer;
            border-radius: 5px;
        }
        .theme-option:hover {
            background: #4a5568;
        }
        .daily-challenge-btn {
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .streak-counter {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2d3748;
            padding: 10px 20px;
            border-radius: 20px;
            display: none;
        }
        .streak-flame {
            color: #ff6b6b;
            margin-right: 5px;
        }
        .dashboard {
            display: none;
            padding: 20px;
        }
        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .dashboard-stats {
            background: #2d3748;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        .stat-item {
            background: #4a5568;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #daff0a;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            color: #a0aec0;
        }
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        .action-button {
            background: #4a5568;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .action-button:hover {
            transform: scale(1.05);
            background: #5a6678;
        }
        .action-button.play-game {
            background: linear-gradient(135deg, #daff0a 0%, #a8c907 100%);
            color: #1a202c;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(218, 255, 10, 0.3);
        }
        .action-button.play-game:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(218, 255, 10, 0.4);
        }
        .action-button.play-game:active {
            transform: scale(0.95);
        }
        .action-button.play-game .button-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .play-icon-container {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        .action-button.play-game:hover .play-icon-container {
            transform: rotate(360deg);
            background: rgba(255, 255, 255, 0.3);
        }
        .play-icon {
            font-size: 30px;
            color: #1a202c;
        }
        .button-text {
            font-size: 18px;
            font-weight: bold;
        }
        .button-subtext {
            font-size: 14px;
            opacity: 0.8;
        }
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        .game-mode-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .game-mode-content {
            background: #2d3748;
            padding: 30px;
            border-radius: 20px;
            max-width: 90%;
            width: 400px;
            text-align: center;
        }
        .mode-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        .mode-option {
            background: #4a5568;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        .mode-option:hover {
            transform: scale(1.05);
            background: #5a6678;
        }
        .mode-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        .mode-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .mode-description {
            font-size: 14px;
            color: #a0aec0;
        }
        .recent-achievements {
            margin-top: 20px;
            background: #2d3748;
            padding: 20px;
            border-radius: 15px;
        }
        .achievement-list {
            margin-top: 15px;
        }
        .recent-achievement-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #4a5568;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        .shop-section {
            display: none;
            padding: 20px;
        }
        .shop-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .shop-balance {
            background: #2d3748;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }
        .balance-amount {
            font-size: 28px;
            color: #daff0a;
            font-weight: bold;
        }
        .shop-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        .shop-item {
            background: #2d3748;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.2s;
        }
        .shop-item:hover {
            transform: scale(1.02);
        }
        .item-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }
        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .item-description {
            font-size: 12px;
            color: #a0aec0;
            margin-bottom: 10px;
            min-height: 36px;
        }
        .item-price {
            color: #daff0a;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .buy-button {
            background: #4a5568;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .buy-button:hover {
            background: #5a6678;
        }
        .buy-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .section {
            display: none;
            padding: 20px;
        }
        .section.active {
            display: block;
        }
        .section-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .back-button {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(74, 85, 104, 0.9);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 100;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(4px);
        }
        .back-button:hover {
            background: rgba(218, 255, 10, 0.9);
            color: #1a202c;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(218, 255, 10, 0.3);
        }
        .back-button:active {
            transform: scale(0.95);
        }
        .back-button i {
            margin-right: 0;
            transition: transform 0.3s ease;
        }
        .back-button:hover i {
            transform: translateX(-2px);
        }
        @media (max-height: 600px) {
            .back-button {
                top: 10px;
                left: 10px;
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
        }
        @media (max-width: 360px) {
            .back-button {
                top: 8px;
                left: 8px;
                width: 30px;
                height: 30px;
                font-size: 14px;
            }
        }
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            padding: 10px;
        }
        .achievement-card {
            background: #2d3748;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.2s;
            position: relative;
            overflow: hidden;
        }
        .achievement-card.locked {
            opacity: 0.6;
        }
        .achievement-card.unlocked {
            animation: achievementUnlock 0.5s ease-out;
        }
        .achievement-card:hover {
            transform: scale(1.02);
        }
        .achievement-icon-container {
            width: 60px;
            height: 60px;
            background: #4a5568;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }
        .achievement-info {
            flex: 1;
        }
        .achievement-name {            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .achievement-description {
            font-size: 14px;
            color: #a0aec0;
        }
        .achievement-progress {
            height: 4px;
            background: #4a5568;
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: #daff0a;
            width: 0%;
            transition: width 0.3s ease;
        }
        .achievement-reward {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #4a5568;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 12px;
            color: #daff0a;
        }
        .settings-section {
            background: #2d3748;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .settings-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #daff0a;
        }
        .settings-grid {
            display: grid;
            gap: 15px;
        }
        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: #4a5568;
            border-radius: 10px;
        }
        .setting-label {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .setting-icon {
            font-size: 20px;
        }
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4a5568;
            transition: .4s;
            border-radius: 24px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #daff0a;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
        }
        .volume-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 4px;
            border-radius: 2px;
            background: #4a5568;
            outline: none;
        }
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #daff0a;
            cursor: pointer;
        }
        .difficulty-select {
            padding: 8px 12px;
            border-radius: 10px;
            background: #1a202c;
            color: white;
            border: 1px solid #4a5568;
            outline: none;
            cursor: pointer;
        }
        .difficulty-select option {
            background: #1a202c;
            color: white;
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 20px;
            }
            .level-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }
            .level-card {
                padding: 15px;
            }
            .level-card .level-number {
                font-size: 20px;
            }
        }
        .daily-rewards-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .daily-rewards-content {
            background: #2d3748;
            padding: 30px;
            border-radius: 20px;
            max-width: 90%;
            width: 400px;
            text-align: center;
            position: relative;
        }
        .rewards-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #daff0a;
        }
        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .reward-day {
            background: #4a5568;
            border-radius: 10px;
            padding: 10px 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
            position: relative;
        }
        .reward-day.current {
            background: rgba(218, 255, 10, 0.2);
            border: 2px solid #daff0a;
        }
        .reward-day.claimed {
            background: #2d3748;
            opacity: 0.7;
        }
        .reward-day.claimed::after {
            content: "✓";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #daff0a;
        }
        .day-number {
            font-size: 12px;
            color: #a0aec0;
        }
        .reward-amount {
            font-size: 16px;
            font-weight: bold;
            color: #daff0a;
        }
        .reward-icon {
            font-size: 20px;
        }
        .streak-info {
            margin: 20px 0;
            padding: 15px;
            background: rgba(74, 85, 104, 0.5);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .streak-flame {
            color: #ff6b6b;
            font-size: 24px;
            animation: flicker 1s infinite alternate;
        }
        @keyframes flicker {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        .claim-button {
            background: #daff0a;
            color: #1a202c;
            border: none;
            padding: 12px 30px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        .claim-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(218, 255, 10, 0.3);
        }
        .claim-button:disabled {
            background: #4a5568;
            cursor: not-allowed;
            transform: none;
        }
        @media (max-width: 480px) {
            .rewards-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            .reward-day:nth-child(n+5) {
                grid-column: span 2;
            }
            .reward-day:last-child {
                grid-column: 2 / 4;
            }
        }

        /* Developer Mode Styles */
        .developer-tools {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .dev-button {
            background: #2d3748;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            width: 100%;
            margin: 8px 0;
        }

        .dev-button:hover {
            background: #4a5568;
            transform: translateY(-2px);
        }

        .dev-button.danger {
            background: #e53e3e;
        }

        .dev-button.danger:hover {
            background: #c53030;
        }

        .dev-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #2d3748;
            border-radius: 8px;
            margin: 8px 0;
        }

        .dev-close {
            background: #2d3748;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            width: 100%;
        }

        #debugLogs {
            position: fixed;
            bottom: 70px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-width: 300px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        /* Profile Styles */
        .profile-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px 0;
        }

        .profile-avatar-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .current-avatar {
            width: 120px;
            height: 120px;
            border-radius: 60px;
            overflow: hidden;
            background: #2d3748;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #daff0a;
        }

        .current-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-button {
            background: #2d3748;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .profile-button:hover {
            background: #4a5568;
            transform: translateY(-2px);
        }

        .profile-button.save {
            background: #daff0a;
            color: #1a202c;
            font-weight: bold;
        }

        .profile-button.save:hover {
            background: #c8eb09;
        }

        .profile-input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .profile-input-group label {
            font-size: 14px;
            color: #a0aec0;
        }

        .profile-input-group input {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #4a5568;
            background: #2d3748;
            color: white;
            font-size: 16px;
        }

        .profile-input-group input:focus {
            outline: none;
            border-color: #daff0a;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            background: #2d3748;
            padding: 15px;
            border-radius: 12px;
        }

        .profile-stats .stat-item {
            text-align: center;
        }

        .profile-stats .stat-label {
            font-size: 12px;
            color: #a0aec0;
            margin-bottom: 5px;
        }

        .profile-stats .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #daff0a;
        }

        .profile-trigger {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(74, 85, 104, 0.9);
            border: 2px solid #daff0a;
            padding: 0;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            z-index: 101;
        }

        .profile-trigger:hover {
            transform: translateY(-50%) scale(1.1);
            border-color: #fff;
        }

        .profile-trigger img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-trigger:active {
            transform: translateY(-50%) scale(0.95);
        }

        @media (max-width: 480px) {
            .profile-stats {
                grid-template-columns: 1fr;
            }
        }

        /* Audio Settings Styles */
        .settings-section {
            background: rgba(45, 55, 72, 0.9);
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            width: 100%;
            max-width: 500px;
        }

        .settings-title {
            color: #daff0a;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: left;
        }

        .settings-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: rgba(74, 85, 104, 0.3);
            border-radius: 10px;
            min-height: 50px;
        }

        .setting-label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-size: 1rem;
        }

        .setting-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        /* Toggle Switch Styles */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4a5568;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #daff0a;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        /* Responsive Styles */
        @media (max-width: 480px) {
            .settings-section {
                padding: 12px;
                margin: 8px 0;
            }

            .settings-title {
                font-size: 1.1rem;
                margin-bottom: 12px;
            }

            .setting-item {
                padding: 6px 8px;
                min-height: 45px;
            }

            .setting-label {
                font-size: 0.9rem;
                gap: 8px;
            }

            .setting-icon {
                font-size: 1.1rem;
                width: 20px;
            }

            .toggle-switch {
                width: 46px;
                height: 24px;
            }

            .toggle-slider:before {
                height: 18px;
                width: 18px;
            }

            input:checked + .toggle-slider:before {
                transform: translateX(22px);
            }
        }

        @media (max-width: 360px) {
            .settings-section {
                padding: 10px;
                margin: 6px 0;
            }

            .settings-title {
                font-size: 1rem;
                margin-bottom: 10px;
            }

            .setting-item {
                padding: 5px 6px;
                min-height: 40px;
            }

            .setting-label {
                font-size: 0.85rem;
                gap: 6px;
            }

            .setting-icon {
                font-size: 1rem;
                width: 18px;
            }

            .toggle-switch {
                width: 42px;
                height: 22px;
            }

            .toggle-slider:before {
                height: 16px;
                width: 16px;
            }

            input:checked + .toggle-slider:before {
                transform: translateX(20px);
            }
        }

        /* Theme Options Styles */
        .theme-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .theme-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: var(--bg-card);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            transform: translateY(-2px);
        }

        .theme-btn.active {
            background: var(--accent-color);
            color: var(--bg-primary);
        }

        .theme-preview {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--text-secondary);
        }

        .theme-btn.default .theme-preview {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border-color: #daff0a;
        }

        .theme-btn.light .theme-preview {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-color: #3182ce;
        }

        .theme-btn.neon .theme-preview {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            border-color: #00ff00;
            box-shadow: 0 0 5px #00ff00;
        }

        /* Responsive Styles */
        @media (max-width: 480px) {
            .theme-options {
                flex-wrap: wrap;
                justify-content: flex-end;
            }

            .theme-btn {
                padding: 6px 10px;
                font-size: 0.9rem;
            }

            .theme-preview {
                width: 16px;
                height: 16px;
            }
        }

        @media (max-width: 360px) {
            .theme-btn {
                padding: 5px 8px;
                font-size: 0.85rem;
            }

            .theme-preview {
                width: 14px;
                height: 14px;
            }
        }

        /* Settings Select Styles */
        .settings-select {
            padding: 8px 12px;
            border-radius: 20px;
            border: 2px solid var(--accent-color);
            background: var(--bg-card);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .settings-select:hover {
            background: var(--bg-secondary);
        }

        .settings-select:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--accent-color);
        }

        .settings-select option {
            background: var(--bg-primary);
            color: var(--text-primary);
            padding: 8px;
        }

        @media (max-width: 480px) {
            .settings-select {
                padding: 6px 10px;
                font-size: 0.9rem;
                min-width: 100px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div class="header">
        <h1>Memory Game For Excel ❤️</h1>
        <button class="profile-trigger" onclick="showProfile()" id="profileTrigger">
            <img src="https://api.dicebear.com/6.x/fun-emoji/svg?seed=default" alt="Profile">
        </button>
    </div>

    <div class="app-container main-content">
        <!-- Dashboard Section -->
        <div class="section" id="dashboard">
            <div class="dashboard-header">
                <h2>Welcome Back! 👋</h2>
            </div>
            
            <div class="dashboard-stats">
                <h3>Your Progress</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="levelDisplay">1</div>
                        <div class="stat-label">Current Level</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="coinsDisplay">30</div>
                        <div class="stat-label">Total Coins</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="achievementsDisplay">0</div>
                        <div class="stat-label">Achievements</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="streakDisplay">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <div class="action-button play-game" onclick="showGameModeSelection()">
                    <div class="button-content">
                        <div class="play-icon-container">
                            <i class="fa-solid fa-play play-icon"></i>
                        </div>
                        <div class="button-text">Play Game</div>
                        <div class="button-subtext">Level ${currentLevel}</div>
                    </div>
                </div>
                <div class="action-button" onclick="startDailyChallenge()">
                    <div class="action-icon">🎯</div>
                    <div>Daily Challenge</div>
                </div>
                <div class="action-button" onclick="showSection('achievements')">
                    <div class="action-icon">🏆</div>
                    <div>Achievements</div>
                </div>
                <div class="action-button" onclick="showSection('shop')">
                    <div class="action-icon">🛍️</div>
                    <div>Shop</div>
                </div>
            </div>

            <div class="recent-achievements">
                <h3>Recent Achievements</h3>
                <div class="achievement-list" id="recentAchievements">
                    <!-- Recent achievements will be added here dynamically -->
                </div>
            </div>
        </div>

        <!-- Shop Section -->
        <div class="section" id="shopSection">
            <button class="back-button" onclick="showSection('menu')" aria-label="Go back to menu">
                <i class="fa-solid fa-chevron-left"></i>
            </button>
            <div class="section-header">
                <h2>Shop</h2>
            </div>
            <div class="shop-balance">
                <div>Your Balance</div>
                <div class="balance-amount">
                    <span id="shopCoinsDisplay">0</span> ��
                </div>
            </div>
            <div class="shop-items">
                <div class="shop-item">
                    <div class="item-icon">🎯</div>
                    <div class="item-name">Hint Pack</div>
                    <div class="item-description">Get 3 hints to help you find matching pairs</div>
                    <div class="item-price">30 💰</div>
                    <button class="buy-button" onclick="buyItem('hint', 30, 3)">Buy Now</button>
                </div>
                <div class="shop-item">
                    <div class="item-icon">⏰</div>
                    <div class="item-name">Time Freeze Pack</div>
                    <div class="item-description">Get 2 time freeze power-ups</div>
                    <div class="item-price">40 💰</div>
                    <button class="buy-button" onclick="buyItem('freeze', 40, 2)">Buy Now</button>
                </div>
                <div class="shop-item">
                    <div class="item-icon">🎯</div>
                    <div class="item-name">Second Chance Pack</div>
                    <div class="item-description">Get 2 second chance power-ups</div>
                    <div class="item-price">35 💰</div>
                    <button class="buy-button" onclick="buyItem('chance', 35, 2)">Buy Now</button>
                </div>
                <div class="shop-item">
                    <div class="item-icon">👁️</div>
                    <div class="item-name">Quick Peek Pack</div>
                    <div class="item-description">Get 2 quick peek power-ups</div>
                    <div class="item-price">35 💰</div>
                    <button class="buy-button" onclick="buyItem('peek', 35, 2)">Buy Now</button>
                </div>
                <div class="shop-item">
                    <div class="item-icon">🌟</div>
                    <div class="item-name">Premium Bundle</div>
                    <div class="item-description">Get 3 of each power-up at a discount!</div>
                    <div class="item-price">100 💰</div>
                    <button class="buy-button" onclick="buyBundle()">Buy Now</button>
                </div>
            </div>
        </div>

        <!-- Game Menu Section -->
        <div class="section" id="menu">
            <button onclick="showLevelSelect('single')">Single Player</button>
            <button onclick="showLevelSelect('multi')">Multiplayer</button>
            <button class="daily-challenge-btn" onclick="startDailyChallenge()">Daily Challenge 🎯</button>
        </div>

        <div class="streak-counter" id="streakCounter">
            <span class="streak-flame">🔥</span>
            <span id="streakCount">0</span> day streak
        </div>

        <!-- Level Select Section -->
        <div class="section" id="levelSelect">
            <button class="back-button" onclick="showSection('menu')" aria-label="Go back to menu">
                <i class="fa-solid fa-chevron-left"></i>
            </button>
            <div class="section-header">
                <h2>Select Level</h2>
            </div>
            <div class="level-grid" id="levelGrid"></div>
        </div>

        <!-- Game Section -->
        <div class="section" id="gameSection">
            <button class="back-button" onclick="backToLevelSelect()" aria-label="Go back">
                <i class="fa-solid fa-chevron-left"></i>
            </button>
            <div class="timer" id="timer">Time: 0s</div>
            <div class="scores" id="scores">
                <div id="player1Container">Player 1: <span id="player1Score">0</span></div>
                <div id="player2Container">Player 2: <span id="player2Score">0</span></div>
            </div>
            <div class="progress" id="progress">Stars: ★★★ | Coins: 30💰</div>
            <div id="gameBoard" class="grid"></div>
            <div class="hearts-container" id="heartsContainer"></div>
            <div class="game-controls" id="gameControls">
                <button id="pauseBtn" onclick="togglePause()">Pause</button>
                <button id="backBtn" onclick="backToLevelSelect()">Back</button>
                <button id="hintBtn" onclick="useHint()">Hint (3)</button>
                <button id="revealBtn" onclick="useRevealAll()">Reveal All (1)</button>
                <button id="buyHintInGameBtn" onclick="buyHintInGame()">Buy Hint (30 coins)</button>
            </div>
            <div class="power-ups" id="powerUps">
                <div class="power-up" onclick="usePowerUp('freeze')" id="freezePowerUp">
                    <div class="power-up-icon">⏸️</div>
                    <div>Freeze Time</div>
                    <div class="power-up-count" id="freezeCount">x2</div>
                </div>
                <div class="power-up" onclick="usePowerUp('chance')" id="chancePowerUp">
                    <div class="power-up-icon">🎯</div>
                    <div>Second Chance</div>
                    <div class="power-up-count" id="chanceCount">x2</div>
                </div>
                <div class="power-up" onclick="usePowerUp('peek')" id="peekPowerUp">
                    <div class="power-up-icon">👁️</div>
                    <div>Quick Peek</div>
                    <div class="power-up-count" id="peekCount">x2</div>
                </div>
            </div>
        </div>

        <!-- Achievements Section -->
        <div class="section" id="achievementsPanel">
            <button class="back-button" onclick="showSection('menu')" aria-label="Go back to menu">
                <i class="fa-solid fa-chevron-left"></i>
            </button>
            <div class="section-header">
                <h2>Achievements</h2>
            </div>
            <div class="achievements-grid">
                <div class="achievement-card" id="achievement-speed">
                    <div class="achievement-icon-container">⚡</div>
                    <div class="achievement-info">
                        <div class="achievement-name">Speed Demon</div>
                        <div class="achievement-description">Complete any level under 30 seconds</div>
                        <div class="achievement-progress">
                            <div class="progress-bar" id="speedProgress"></div>
                        </div>
                    </div>
                    <div class="achievement-reward">50 💰</div>
                </div>
                <div class="achievement-card" id="achievement-perfect">
                    <div class="achievement-icon-container">🎯</div>
                    <div class="achievement-info">
                        <div class="achievement-name">Perfect Match</div>
                        <div class="achievement-description">Complete a level with no mistakes</div>
                        <div class="achievement-progress">
                            <div class="progress-bar" id="perfectProgress"></div>
                        </div>
                    </div>
                    <div class="achievement-reward">75 💰</div>
                </div>
                <div class="achievement-card" id="achievement-master">
                    <div class="achievement-icon-container">👑</div>
                    <div class="achievement-info">
                        <div class="achievement-name">Memory Master</div>
                        <div class="achievement-description">Complete all 12 levels</div>
                        <div class="achievement-progress">
                            <div class="progress-bar" id="masterProgress"></div>
                        </div>
                    </div>
                    <div class="achievement-reward">100 💰</div>
                </div>
                <div class="achievement-card" id="achievement-streak">
                    <div class="achievement-icon-container">🔥</div>
                    <div class="achievement-info">
                        <div class="achievement-name">Hot Streak</div>
                        <div class="achievement-description">Maintain a 7-day play streak</div>
                        <div class="achievement-progress">
                            <div class="progress-bar" id="streakProgress"></div>
                        </div>
                    </div>
                    <div class="achievement-reward">80 💰</div>
                </div>
                <div class="achievement-card" id="achievement-collector">
                    <div class="achievement-icon-container">💫</div>
                    <div class="achievement-info">
                        <div class="achievement-name">Star Collector</div>
                        <div class="achievement-description">Earn 3 stars in 5 different levels</div>
                        <div class="achievement-progress">
                            <div class="progress-bar" id="collectorProgress"></div>
                        </div>
                    </div>
                    <div class="achievement-reward">60 💰</div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="section" id="settingsSection">
            <button class="back-button" onclick="showSection('menu')" aria-label="Go back to menu">
                <i class="fa-solid fa-chevron-left"></i>
            </button>
            <div class="section-header">
                <h2>Settings</h2>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">Game Settings</div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fa-solid fa-gauge-high setting-icon"></i>
                            <span>Difficulty</span>
                        </div>
                        <select class="difficulty-select" onchange="changeDifficulty(this.value)">
                            <option value="easy">Easy</option>
                            <option value="normal" selected>Normal</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fa-solid fa-clock setting-icon"></i>
                            <span>Extended Time Mode</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" onchange="toggleExtendedTime(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">Audio Settings</div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fa-solid fa-music setting-icon"></i>
                            <span>Background Music</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="bgmToggle" checked onchange="toggleBGM(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fa-solid fa-volume-high setting-icon"></i>
                            <span>Sound Effects</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="sfxToggle" checked onchange="toggleSFX(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">Theme Settings</div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fa-solid fa-palette setting-icon"></i>
                            <span>Theme</span>
                        </div>
                        <select class="settings-select" onchange="changeTheme(this.value)">
                            <option value="default">Default</option>
                            <option value="light">Light</option>
                            <option value="neon">Neon</option>
                        </select>
                    </div>
                </div>
            </div>

            <style>
                /* Settings Select Styles */
                .settings-select {
                    padding: 8px 12px;
                    border-radius: 20px;
                    border: 2px solid var(--accent-color);
                    background: var(--bg-card);
                    color: var(--text-primary);
                    cursor: pointer;
                    font-size: 1rem;
                    transition: all 0.3s ease;
                    min-width: 120px;
                }

                .settings-select:hover {
                    background: var(--bg-secondary);
                }

                .settings-select:focus {
                    outline: none;
                    box-shadow: 0 0 0 2px var(--accent-color);
                }

                .settings-select option {
                    background: var(--bg-primary);
                    color: var(--text-primary);
                    padding: 8px;
                }

                @media (max-width: 480px) {
                    .settings-select {
                        padding: 6px 10px;
                        font-size: 0.9rem;
                        min-width: 100px;
                    }
                }
            </style>

            <script>
                // Theme Management
                function changeTheme(theme) {
                    // Set theme variables
                    const themes = {
                        default: {
                            '--bg-primary': '#1a1a2e',      // Darker blue-black
                            '--bg-secondary': '#16213e',    // Dark navy
                            '--bg-card': '#0f3460',         // Deep blue
                            '--text-primary': '#e2e8f0',    // Light gray
                            '--text-secondary': '#a0aec0',  // Medium gray
                            '--accent-color': '#daff0a',    // Lime
                            '--card-border': 'none',
                            '--card-shadow': '0 4px 6px rgba(0, 0, 0, 0.3)'
                        },
                        light: {
                            '--bg-primary': '#ffffff',      // Pure white
                            '--bg-secondary': '#f8fafc',    // Very light gray
                            '--bg-card': '#f1f5f9',         // Light gray
                            '--text-primary': '#1e293b',    // Dark blue-gray
                            '--text-secondary': '#475569',  // Medium blue-gray
                            '--accent-color': '#3b82f6',    // Bright blue
                            '--card-border': '1px solid #e2e8f0',
                            '--card-shadow': '0 2px 4px rgba(0, 0, 0, 0.05)'
                        },
                        neon: {
                            '--bg-primary': '#000000',      // Pure black
                            '--bg-secondary': '#0a0a0a',    // Almost black
                            '--bg-card': '#1a1a1a',         // Very dark gray
                            '--text-primary': '#00ff00',    // Bright green
                            '--text-secondary': '#00cc00',  // Slightly darker green
                            '--accent-color': '#ff00ff',    // Magenta
                            '--card-border': '1px solid #00ff00',
                            '--card-shadow': '0 0 10px rgba(0, 255, 0, 0.3)'
                        }
                    };

                    // Apply theme colors
                    const root = document.documentElement;
                    const themeColors = themes[theme];
                    Object.keys(themeColors).forEach(property => {
                        root.style.setProperty(property, themeColors[property]);
                    });

                    // Save theme preference
                    localStorage.setItem('theme', theme);
                    
                    // Show feedback
                    showToast(`${theme.charAt(0).toUpperCase() + theme.slice(1)} theme applied`);
                }

                // Initialize theme
                window.addEventListener('DOMContentLoaded', () => {
                    const savedTheme = localStorage.getItem('theme') || 'default';
                    // Set the select value
                    document.querySelector('.settings-select').value = savedTheme;
                    // Apply the theme
                    changeTheme(savedTheme);
                });
            </script>

            <div class="settings-section">
                <div class="settings-title">Developer Settings</div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div class="setting-label">
                            <i class="fa-solid fa-code setting-icon"></i>
                            <span>Developer Mode</span>
                        </div>
                        <button id="devModeBtn" class="dev-mode-btn" onclick="devTools.toggle()">
                            Enable
                        </button>
                    </div>
                </div>
            </div>

            <style>
                /* Theme Options Styles */
                .theme-options {
                    display: flex;
                    gap: 10px;
                    align-items: center;
                }

                .theme-btn {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    padding: 8px 12px;
                    border: none;
                    border-radius: 20px;
                    background: var(--bg-card);
                    color: var(--text-primary);
                    cursor: pointer;
                    transition: all 0.3s ease;
                }

                .theme-btn:hover {
                    transform: translateY(-2px);
                }

                .theme-btn.active {
                    background: var(--accent-color);
                    color: var(--bg-primary);
                }

                .theme-preview {
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    border: 2px solid var(--text-secondary);
                }

                .theme-btn.default .theme-preview {
                    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
                    border-color: #daff0a;
                }

                .theme-btn.light .theme-preview {
                    background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
                    border-color: #3182ce;
                }

                .theme-btn.neon .theme-preview {
                    background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
                    border-color: #00ff00;
                    box-shadow: 0 0 5px #00ff00;
                }

                /* Responsive Styles */
                @media (max-width: 480px) {
                    .theme-options {
                        flex-wrap: wrap;
                        justify-content: flex-end;
                    }

                    .theme-btn {
                        padding: 6px 10px;
                        font-size: 0.9rem;
                    }

                    .theme-preview {
                        width: 16px;
                        height: 16px;
                    }
                }

                @media (max-width: 360px) {
                    .theme-btn {
                        padding: 5px 8px;
                        font-size: 0.85rem;
                    }

                    .theme-preview {
                        width: 14px;
                        height: 14px;
                    }
                }
            </style>

            <script>
                // Developer Tools Implementation
                const devTools = {
                    isEnabled: false,
                    password: "Possigee.1",

                    init() {
                        this.isEnabled = localStorage.getItem('devMode') === 'true';
                        const btn = document.getElementById('devModeBtn');
                        if (btn && this.isEnabled) {
                            btn.textContent = 'Disable';
                        }
                        if (this.isEnabled) {
                            this.showPanel();
                        }
                    },

                    toggle() {
                        const btn = document.getElementById('devModeBtn');
                        if (this.isEnabled) {
                            this.isEnabled = false;
                            localStorage.setItem('devMode', 'false');
                            btn.textContent = 'Enable';
                            showToast('Developer Mode Deactivated');
                            document.getElementById('developerModal').style.display = 'none';
                        } else {
                            const password = prompt("Enter developer password:");
                            if (password === this.password) {
                                this.isEnabled = true;
                                localStorage.setItem('devMode', 'true');
                                btn.textContent = 'Disable';
                                showToast('🛠️ Developer Mode Activated!');
                                this.showPanel();
                            } else if (password !== null) {
                                showToast('Incorrect password!');
                            }
                        }
                    },

                    showPanel() {
                        if (!this.isEnabled) return;
                        const modal = document.getElementById('developerModal');
                        if (modal) {
                            modal.style.display = 'flex';
                        }
                    },

                    addCoins(amount) {
                        totalCoins += amount;
                        localStorage.setItem('totalCoins', totalCoins);
                        updateProgress();
                        showToast(`Added ${amount} coins!`);
                    },

                    unlockAllLevels() {
                        unlockedLevels = 12;
                        localStorage.setItem('unlockedLevels', unlockedLevels);
                        for (let i = 1; i <= 12; i++) {
                            levelStars[i] = '★★★';
                        }
                        localStorage.setItem('levelStars', JSON.stringify(levelStars));
                        showToast('All levels unlocked with 3 stars!');
                    },

                    unlockAllAchievements() {
                        // Set all achievements to true
                        achievements = {
                            speed: true,    // Complete a level in under 30 seconds
                            perfect: true,  // Complete a level without mistakes
                            master: true,   // Complete all levels
                            streak: true    // Maintain a 7-day streak
                        };
                        
                        // Update achievement progress
                        achievementProgress = {
                            speed: 25,      // Best time in seconds
                            perfect: 5,     // Perfect games count
                            master: 12,     // Current level (out of 12)
                            streak: 7       // Current daily streak
                        };
                        
                        // Save to localStorage
                        localStorage.setItem('achievements', JSON.stringify(achievements));
                        localStorage.setItem('achievementProgress', JSON.stringify(achievementProgress));
                        
                        // Update UI
                        updateAchievementProgress();
                        updateAchievementCards();
                        
                        // Add coins reward for achievements
                        totalCoins += 400; // 100 coins per achievement
                        localStorage.setItem('totalCoins', totalCoins);
                        updateCoins();
                        
                        showToast('All achievements unlocked! +400 coins');
                    },

                    resetAllProgress() {
                        if (confirm('Are you sure you want to reset ALL progress? This cannot be undone!')) {
                            localStorage.clear();
                            showToast('All progress reset! Reloading...');
                            setTimeout(() => location.reload(), 1500);
                        }
                    }
                };

                // Initialize developer mode
                window.addEventListener('DOMContentLoaded', () => {
                    devTools.init();
                });

                // Check developer mode state on load
                window.addEventListener('DOMContentLoaded', () => {
                    const btn = document.getElementById('devModeBtn');
                    if (localStorage.getItem('devMode') === 'true') {
                        btn.textContent = 'Disable';
                    }
                });
            </script>
        </div>
    </div>

    <div class="bottom-nav">
        <button class="nav-item active" onclick="showSection('menu')">
            <i class="fa-solid fa-house"></i>
            <span>Home</span>
        </button>
        <button class="nav-item" onclick="showSection('achievements')">
            <i class="fa-solid fa-trophy"></i>
            <span>Awards</span>
            <span class="notification-dot"></span>
        </button>
        <button class="nav-item" onclick="showSection('shop')">
            <i class="fa-solid fa-store"></i>
            <span>Shop</span>
            <span class="notification-dot"></span>
        </button>
        <button class="nav-item" onclick="showSection('settings')">
            <i class="fa-solid fa-gear"></i>
            <span>Settings</span>
        </button>
    </div>

    <div id="gameOverModal" class="modal">
        <div class="modal-content">
            <h2>Game Over! 😢</h2>
            <p>You ran out of time!</p>
            <div class="modal-buttons">
                <button onclick="restartCurrentLevel()">Continue from Level <span id="currentLevelDisplay">1</span></button>
                <button onclick="resetProgress(); location.reload();">Start from Beginning</button>
            </div>
        </div>
    </div>

    <div id="levelCompleteModal" class="modal">
        <div class="modal-content">
            <h2 id="levelCompleteTitle">Level Complete! 🎉</h2>
            <div id="modalMessage">
                <div id="modalStars" style="font-size: 24px; margin: 15px 0;"></div>
                <div id="modalCoins"></div>
                <div class="coin-shop">
                    <h3>Coin Shop 💰</h3>
                    <p>Total Coins: <span id="totalCoinsDisplay">30</span></p>
                    <button onclick="buyHint()">Buy Hint (30 coins)</button>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="nextLevelBtn">Next Level</button>
                <button id="playAgainBtn2" onclick="resetProgress(); location.reload();">Play Again</button>
            </div>
        </div>
    </div>

    <div id="finalLevelModal" class="modal">
        <div class="modal-content">
            <h2>Amazing! You Completed All Levels! 🎉🎉🎉</h2>
            <p>Enter your boyfriend's name to see a special message:</p>
            <div class="name-input">
                <input type="text" id="boyfriendName" placeholder="Type his name...">
                <button onclick="checkName()">Submit</button>
            </div>
            <div id="loveMessage" class="love-message"></div>
            <div class="modal-buttons">
                <button onclick="location.reload()">Play Again</button>
            </div>
        </div>
    </div>

    <div id="dailyChallengeModal" class="modal">
        <div class="modal-content">
            <h2>Daily Challenge</h2>
            <div id="dailyChallengeDesc"></div>
            <div id="dailyRewards"></div>
            <div class="modal-buttons">
                <button onclick="startDailyChallenge(true)">Start Challenge</button>
                <button onclick="document.getElementById('dailyChallengeModal').style.display='none'">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add this new modal after other modals -->
    <div id="gameModeModal" class="game-mode-modal">
        <div class="game-mode-content">
            <h2>Select Game Mode</h2>
            <div class="mode-options">
                <div class="mode-option" onclick="startGameMode('single')">
                    <div class="mode-icon">👤</div>
                    <div class="mode-title">Single Player</div>
                    <div class="mode-description">Challenge yourself!</div>
                </div>
                <div class="mode-option" onclick="startGameMode('multi')">
                    <div class="mode-icon">👥</div>
                    <div class="mode-title">Multiplayer</div>
                    <div class="mode-description">Play with friends!</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio elements for sound effects and background music -->
    <audio id="flipSound" src="flip.mp3"></audio>
    <audio id="matchSound" src="match.mp3"></audio>
    <audio id="winSound" src="win.mp3"></audio>
    <audio id="errorSound" src="error.mp3"></audio>
    <audio id="backgroundMusic" src="background.mp3" loop></audio>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
    <script>
        const allImages = ["Babe1.jpg", "babe2.jpg", "babe4.jpg", "babe5.jpg", "babe7.jpg", "babe8.jpg", 
                          "babe9.jpg", "babe10.jpg", "babe11.jpg", "babe12.jpg", "babe13.jpg", "babe14.jpg",
                          "babe15.jpg", "babe16.jpg", "babe17.jpg", "babe3.jpg", "babe6.jpg"]; 
        let images = [];
        let cards = [];
        let selectedCards = [];
        let matchedPairs = 0;
        let timer;
        let timeElapsed = 0;
        let gamePaused = false;
        let hintsLeft = 3;
        let revealAllLeft = 1;
        let currentLevel = 1;
        let gridRows = 4;
        let gridCols = 3;
        let isMultiplayer = false;
        let currentPlayer = 1;
        let player1Score = 0;
        let player2Score = 0;
        let totalCoins = 30; // Starting with 30 coins
        let currentGameMode = 'single'; // Track the current game mode
        let powerUps = {
            freeze: 2,
            chance: 2,
            peek: 2
        };
        let secondChanceActive = false;
        let freezeTimeoutId = null;
        let achievements = {
            speed: false,
            perfect: false,
            master: false
        };
        let mistakesMade = 0;
        let themes = {
            default: {
                background: '#1a202c',
                cardBack: '#2d3748',
                text: 'white'
            },
            dark: {
                background: '#000000',
                cardBack: '#1a1a1a',
                text: '#808080'
            },
            neon: {
                background: '#0a0a2a',
                cardBack: '#1a1a4a',
                text: '#00ff00'
            },
            pastel: {
                background: '#ffd1dc',
                cardBack: '#ffb6c1',
                text: '#696969'
            }
        };
        let dailyStreak = 0;
        let lastPlayedDate = null;
        let isDailyChallenge = false;
        let dailyChallengeCompleted = false;
        let unlockedLevels = 1;
        let levelStars = {};
        let selectedGameMode = 'single';

        // Check for saved game state in local storage when page loads
        window.onload = function() {
            const savedLevel = localStorage.getItem('currentLevel');
            if (savedLevel) {
                currentLevel = parseInt(savedLevel);
            }
            
            const savedCoins = localStorage.getItem('totalCoins');
            if (savedCoins) {
                totalCoins = parseInt(savedCoins);
            }
            
            const savedHints = localStorage.getItem('hintsLeft');
            if (savedHints) {
                hintsLeft = parseInt(savedHints);
            }
            
            // Load daily challenge data
            const savedStreak = localStorage.getItem('dailyStreak');
            const savedLastPlayed = localStorage.getItem('lastPlayedDate');
            const savedDailyCompleted = localStorage.getItem('dailyChallengeCompleted');
            
            if (savedStreak) dailyStreak = parseInt(savedStreak);
            if (savedLastPlayed) lastPlayedDate = new Date(savedLastPlayed);
            if (savedDailyCompleted) dailyChallengeCompleted = JSON.parse(savedDailyCompleted);
            
            // Check if streak should be reset
            if (lastPlayedDate) {
                const daysSinceLastPlayed = Math.floor((new Date() - new Date(lastPlayedDate)) / (1000 * 60 * 60 * 24));
                if (daysSinceLastPlayed > 1) {
                    dailyStreak = 0;
                    localStorage.setItem('dailyStreak', dailyStreak);
                }
            }
            
            // Reset daily challenge completion at midnight
            const today = new Date().toDateString();
            if (!lastPlayedDate || new Date(lastPlayedDate).toDateString() !== today) {
                dailyChallengeCompleted = false;
                localStorage.setItem('dailyChallengeCompleted', false);
            }
            
            // Update the progress display with saved values
            updateProgress();
            updateStreakDisplay();
            
            const savedUnlockedLevels = localStorage.getItem('unlockedLevels');
            const savedLevelStars = localStorage.getItem('levelStars');
            
            if (savedUnlockedLevels) {
                unlockedLevels = parseInt(savedUnlockedLevels);
            }
            if (savedLevelStars) {
                levelStars = JSON.parse(savedLevelStars);
            }
            
            // Show dashboard initially
            document.getElementById('dashboard').style.display = 'block';
            updateDashboard();

            const savedSettings = localStorage.getItem('gameSettings');
            if (savedSettings) {
                gameSettings = JSON.parse(savedSettings);
                // Apply saved settings
                document.querySelector('select[onchange="changeDifficulty(this.value)"]').value = 
                    gameSettings.difficulty;
                document.querySelector('input[onchange="toggleExtendedTime(this.checked)"]').checked = 
                    gameSettings.extendedTime;
                document.querySelectorAll('.volume-slider')[0].value = gameSettings.musicVolume;
                document.querySelectorAll('.volume-slider')[1].value = gameSettings.sfxVolume;
                document.querySelector('input[onchange="toggleEffects(this.checked)"]').checked = 
                    gameSettings.visualEffects;
            }
            
            const savedProgress = localStorage.getItem('achievementProgress');
            if (savedProgress) {
                achievementProgress = JSON.parse(savedProgress);
            }
            
            updateAchievementProgress();
        };

        const maxTimeLimits = {
            1: 65,  // 4x3
            2: 75,  // 4x4
            3: 85,  // 5x4
            4: 95,  // 5x5
            5: 105, // 6x5
            6: 115, // 6x6
            7: 125, // 7x6
            8: 135, // 7x7
            9: 145, // 8x7
            10: 160, // 8x8
            11: 175, // 9x8
            12: 190  // 9x9
        };

        // Audio elements
        const flipSound = document.getElementById("flipSound");
        const matchSound = document.getElementById("matchSound");
        const winSound = document.getElementById("winSound");
        const errorSound = document.getElementById("errorSound");
        const backgroundMusic = document.getElementById("backgroundMusic");

        function startGame(mode) {
            currentGameMode = mode;
            isMultiplayer = mode === 'multi';
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show game section
            document.getElementById('gameSection').style.display = 'block';
            document.getElementById('gameBoard').style.display = 'grid';
            document.getElementById('gameControls').style.display = 'flex';
            document.getElementById('powerUps').style.display = 'flex';
            document.getElementById('timer').style.display = 'block';
            document.getElementById('progress').style.display = 'block';
            document.getElementById('scores').style.display = isMultiplayer ? 'flex' : 'none';
            
            // Start background music
            backgroundMusic.play();
            
            updateGridSize();
            initializeGameState();
            createShuffledCards();
            
            alert(`Level ${currentLevel}: You have 5 seconds to memorize the pictures!`);
            revealCardsTemporarily();
            
            // Update Buy Hint button status
            updateBuyHintButtonStatus();
            
            // Save current game state
            saveGameState();
            
            // Show achievements panel
            document.getElementById('achievementsPanel').style.display = 'none';
            
            // Load saved achievements
            const savedAchievements = localStorage.getItem('achievements');
            if (savedAchievements) {
                achievements = JSON.parse(savedAchievements);
                Object.keys(achievements).forEach(id => {
                    if (achievements[id]) {
                        document.getElementById(`achievement-${id}`).classList.add('unlocked');
                    }
                });
            }
            
            // Reset mistakes counter
            mistakesMade = 0;
        }

        function saveGameState() {
            localStorage.setItem('currentLevel', currentLevel);
            localStorage.setItem('totalCoins', totalCoins);
            localStorage.setItem('hintsLeft', hintsLeft);
            localStorage.setItem('gameMode', currentGameMode);
            localStorage.setItem('gameSettings', JSON.stringify(gameSettings));
            localStorage.setItem('achievementProgress', JSON.stringify(achievementProgress));
        }

        function resetProgress() {
            localStorage.removeItem('currentLevel');
            localStorage.removeItem('totalCoins');
            localStorage.removeItem('hintsLeft');
            localStorage.removeItem('gameMode');
            currentLevel = 1;
            totalCoins = 30;
            hintsLeft = 3;
            updateProgress();
        }

        function updateGridSize() {
            switch(currentLevel) {
                case 1:
                    gridRows = 4; gridCols = 3;
                    break;
                case 2:
                    gridRows = 4; gridCols = 4;
                    break;
                case 3:
                    gridRows = 5; gridCols = 4;
                    break;
                case 4:
                    gridRows = 5; gridCols = 5;
                    break;
                case 5:
                    gridRows = 6; gridCols = 5;
                    break;
                case 6:
                    gridRows = 6; gridCols = 6;
                    break;
                case 7:
                    gridRows = 7; gridCols = 6;
                    break;
                case 8:
                    gridRows = 7; gridCols = 7;
                    break;
                case 9:
                    gridRows = 8; gridCols = 7;
                    break;
                case 10:
                    gridRows = 8; gridCols = 8;
                    break;
                case 11:
                    gridRows = 9; gridCols = 8;
                    break;
                case 12:
                    gridRows = 9; gridCols = 9;
                    break;
            }
            
            const gameBoard = document.getElementById("gameBoard");
            gameBoard.style.gridTemplateRows = `repeat(${gridRows}, 1fr)`;
            gameBoard.style.gridTemplateColumns = `repeat(${gridCols}, 1fr)`;
        }

        function initializeGameState() {
            // Reset game variables
            matchedPairs = 0;
            timeElapsed = 0;
            gamePaused = false;
            selectedCards = [];
            
            // Clear the game board
            const gameBoard = document.getElementById("gameBoard");
            gameBoard.innerHTML = "";
            
            // Reset the timer display
            document.getElementById("timer").innerText = "Time: 0s";
            document.getElementById("timer").classList.remove("blink");
            
            // Update progress display
            updateProgress();
            
            // Start the game timer
            startTimer();
        }

        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                if (!gamePaused) {
                    timeElapsed++;
                    document.getElementById("timer").innerText = `Time: ${timeElapsed}s`;
                    
                    // Check if time is getting low (75% of max time)
                    const timeLimit = maxTimeLimits[currentLevel];
                    if (timeElapsed >= timeLimit * 0.75) {
                        document.getElementById("timer").classList.add("blink");
                    }
                    
                    // Check for time limit exceeded
                    if (timeElapsed >= timeLimit) {
                        handleGameOver();
                    }
                }
            }, 1000);
        }

        function createShuffledCards() {
            // Determine number of pairs based on grid size
            const totalPairs = Math.floor((gridRows * gridCols) / 2);
            
            // Shuffle all images and pick the required number
            const shuffledImages = [...allImages].sort(() => Math.random() - 0.5);
            images = shuffledImages.slice(0, totalPairs);
            
            // Create pairs of cards
            let cardPairs = [];
            images.forEach(image => {
                cardPairs.push({ image, id: Math.random() });
                cardPairs.push({ image, id: Math.random() });
            });
            
            // Shuffle the card pairs
            cardPairs = cardPairs.sort(() => Math.random() - 0.5);
            
            // Create card elements and add to game board
            const gameBoard = document.getElementById("gameBoard");
            cardPairs.forEach(card => {
                const cardElement = document.createElement("div");
                cardElement.className = "card hidden";
                cardElement.dataset.image = card.image;
                cardElement.dataset.id = card.id;
                cardElement.onclick = () => flipCard(cardElement);
                gameBoard.appendChild(cardElement);
            });
            
            // Store card elements for later use
            cards = document.querySelectorAll(".card");
        }

        function revealCardsTemporarily() {
            // Show all cards for 5 seconds
            cards.forEach(card => {
                card.style.backgroundImage = `url(${card.dataset.image})`;
            });
            
            setTimeout(() => {
                cards.forEach(card => {
                    card.style.backgroundImage = "url('back.jpg')";
                });
            }, 5000);
        }

        function togglePause() {
            gamePaused = !gamePaused;
            document.getElementById("pauseBtn").innerText = gamePaused ? "Resume" : "Pause";
            
            // Pause or resume background music
            if (gamePaused) {
                backgroundMusic.pause();
            } else {
                backgroundMusic.play();
            }
        }

        function flipCard(card) {
            if (card.classList.contains("revealed") || selectedCards.length === 2 || gamePaused) return;
            
            // Play flip sound
            flipSound.play();
            
            card.style.backgroundImage = `url(${card.dataset.image})`;
            selectedCards.push(card);
            
            if (selectedCards.length === 2) {
                setTimeout(checkMatch, 1000);
            }
        }

        function checkMatch() {
            const [card1, card2] = selectedCards;
            const isMatch = card1.dataset.image === card2.dataset.image;
            
            if (!isMatch && !secondChanceActive) {
                mistakesMade++;
            }
            
            if (isMatch) {
                // Play match sound
                matchSound.play();
                
                card1.classList.add("revealed");
                card2.classList.add("revealed");
                matchedPairs++;
                showHearts();
                
                if (isMultiplayer) {
                    if (currentPlayer === 1) player1Score++;
                    else player2Score++;
                    updateScores();
                }
                
                if (matchedPairs === images.length) {
                    handleLevelComplete();
                }
            } else {
                if (secondChanceActive) {
                    secondChanceActive = false;
                    document.getElementById("chancePowerUp").style.border = "";
                    selectedCards = [];
                    return;
                }
                
                // Play error sound
                errorSound.play();
                
                card1.style.backgroundImage = "url('back.jpg')";
                card2.style.backgroundImage = "url('back.jpg')";
                
                if (isMultiplayer) {
                    currentPlayer = currentPlayer === 1 ? 2 : 1;
                    updatePlayerTurn();
                }
            }
            
            selectedCards = [];
        }

        function handleLevelComplete() {
            checkAchievements();
            
            clearInterval(timer);
            document.getElementById("timer").classList.remove("blink");
            
            const stars = calculateStars();
            const coins = calculateCoins();
            totalCoins += coins;
            
            // Update profile statistics
            userProfile.totalGames++;
            if (!userProfile.bestTime || timeElapsed < userProfile.bestTime) {
                userProfile.bestTime = timeElapsed;
            }
            userProfile.totalStars += stars.split('★').length - 1;
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            
            document.getElementById("modalStars").innerHTML = stars;
            document.getElementById("modalCoins").innerText = `Coins Earned: ${coins}💰`;
            document.getElementById("totalCoinsDisplay").innerText = totalCoins;
            
            // Show confetti for every level completion
            showConfetti();
            
            // Play win sound
            winSound.play();
            
            // Save the updated game state
            saveGameState();
            
            if (currentLevel === 12) {
                document.getElementById("finalLevelModal").style.display = "flex";
            } else {
                document.getElementById("levelCompleteModal").style.display = "flex";
            }
            
            // Update level progress
            if (currentLevel === unlockedLevels && currentLevel < 12) {
                unlockedLevels++;
                localStorage.setItem('unlockedLevels', unlockedLevels);
            }
            
            // Save stars for the level
            levelStars[currentLevel] = stars;
            localStorage.setItem('levelStars', JSON.stringify(levelStars));
            
            // Update profile display
            updateProfileStats();
        }

        function checkName() {
            const name = document.getElementById("boyfriendName").value.trim();
            if (name.toLowerCase() === "possi gee") {
                showLoveMessage();
            } else {
                alert("That's not your boyfriend's name. Try again!");
            }
        }

        function showLoveMessage() {
            const loveMessage = document.getElementById("loveMessage");
            loveMessage.style.display = "block";
            loveMessage.innerHTML = `
                <h3>💖 My Darling 💖</h3>
                <p>You've made it to the end of our memory game! Just like these matching pairs, we're meant to be together.</p>
                <p>Thank you for being the most amazing girlfriend. Your love, support, and the beautiful memories we create together mean everything to me.</p>
                <p>This game is just a small token of my love for you. I hope it brought a smile to your face, just as you bring joy to my life every day.</p>
                <p>I love you more than words can express!</p>
                <p>Forever Yours,<br>Possi Gee ❤️</p>
                <button onclick="location.reload()" style="margin-top: 20px;">Back to Homepage</button>
            `;
            
            // Extra celebration confetti
            showConfetti();
            setTimeout(showConfetti, 1500);
            setTimeout(showConfetti, 3000);
        }

        function handleGameOver() {
            clearInterval(timer);
            
            // Update profile statistics
            userProfile.totalGames++;
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            
            // Update the current level display in the game over modal
            document.getElementById("currentLevelDisplay").textContent = currentLevel;
            document.getElementById("gameOverModal").style.display = "flex";
            
            // Pause background music
            backgroundMusic.pause();
            
            // Save the current game state
            saveGameState();
            
            // Update profile display
            updateProfileStats();
        }

        function restartCurrentLevel() {
            // Close the modal
            document.getElementById("gameOverModal").style.display = "none";
            
            // Restart the game with the same level and game mode
            startGame(currentGameMode);
        }

        function calculateStars() {
            const timeLimit = maxTimeLimits[currentLevel];
            if (timeElapsed <= timeLimit - 25) return "★★★";
            if (timeElapsed <= timeLimit - 15) return "★★";
            return "★";
        }

        function calculateCoins() {
            // New coin reward system based on completion time
            const timeLimit = maxTimeLimits[currentLevel];
            const baseCoins = 30 * currentLevel;
            
            if (timeElapsed <= 40) {
                return baseCoins; // Full reward for quick completion
            } else if (timeElapsed <= 50) {
                return 20 * currentLevel; // Reduced reward
            } else if (timeElapsed <= 60) {
                return 10 * currentLevel; // Minimal reward
            } else if (timeElapsed >= timeLimit - 5) {
                return 0; // No coins if finished in last 5 seconds
            } else {
                return 5 * currentLevel; // Very small reward for slow completion
            }
        }

        function updateScores() {
            document.getElementById("player1Score").innerText = player1Score;
            document.getElementById("player2Score").innerText = player2Score;
            if (isMultiplayer) updatePlayerTurn();
        }

        function updatePlayerTurn() {
            document.getElementById("player1Container").classList.toggle("current-player", currentPlayer === 1);
            document.getElementById("player2Container").classList.toggle("current-player", currentPlayer === 2);
        }

        function useHint() {
            if (hintsLeft <= 0) {
                alert("You have no hints left! You can buy more with 30 coins.");
                return;
            }
            
            hintsLeft--;
            document.getElementById("hintBtn").innerText = `Hint (${hintsLeft})`;
            
            const unrevealedCards = Array.from(document.querySelectorAll('.card:not(.revealed)'));
            const cardMap = new Map();
            
            for (const card of unrevealedCards) {
                const image = card.dataset.image;
                if (cardMap.has(image)) {
                    showHintPair(card, cardMap.get(image));
                    break;
                }
                cardMap.set(image, card);
            }
            
            // Update the progress display
            updateProgress();
            
            // Save the updated game state
            saveGameState();
        }

        function showHintPair(card1, card2) {
            const image = card1.dataset.image;
            card1.style.backgroundImage = `url(${image})`;
            card2.style.backgroundImage = `url(${image})`;
            
            setTimeout(() => {
                if (!card1.classList.contains("revealed")) {
                    card1.style.backgroundImage = "url('back.jpg')";
                }
                if (!card2.classList.contains("revealed")) {
                    card2.style.backgroundImage = "url('back.jpg')";
                }
            }, 1000);
        }

        function buyHint() {
            if (totalCoins >= 30) {
                totalCoins -= 30;
                hintsLeft++;
                document.getElementById('hintBtn').innerText = `Hint (${hintsLeft})`;
                updateProgress();
                
                // Save the updated game state
                saveGameState();
            } else {
                alert("Not enough coins! Complete levels faster to earn more!");
            }
        }

        function buyHintInGame() {
            if (totalCoins >= 30) {
                totalCoins -= 30;
                hintsLeft++;
                document.getElementById("hintBtn").innerText = `Hint (${hintsLeft})`;
                updateProgress();
                alert("Hint purchased! You now have " + hintsLeft + " hints.");
                
                // Save the updated game state
                saveGameState();
            } else {
                alert("Not enough coins! You need 30 coins to buy a hint.");
            }
        }

        function updateBuyHintButtonStatus() {
            const buyHintBtn = document.getElementById("buyHintInGameBtn");
            buyHintBtn.disabled = totalCoins < 30;
        }

        function useRevealAll() {
            if (revealAllLeft <= 0) return;
            
            revealAllLeft--;
            document.getElementById("revealBtn").innerText = `Reveal All (${revealAllLeft})`;
            
            const unrevealedCards = document.querySelectorAll('.card:not(.revealed)');
            unrevealedCards.forEach(card => {
                card.style.backgroundImage = `url(${card.dataset.image})`;
            });
            
            setTimeout(() => {
                unrevealedCards.forEach(card => {
                    if (!card.classList.contains("revealed")) {
                        card.style.backgroundImage = "url('back.jpg')";
                    }
                });
            }, 2000);
            
            // Save the updated game state
            saveGameState();
        }

        function updateProgress() {
            document.getElementById("progress").innerHTML = 
                `Level: ${currentLevel} | Hints: ${hintsLeft} | Coins: ${totalCoins}💰`;
            
            // Update the Buy Hint button status
            updateBuyHintButtonStatus();
        }

        function showConfetti() {
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#ff0a54', '#ff477e', '#ff7096', '#ff85a1', '#fbb1bd', '#f9bec7']
            });
        }

        function showHearts() {
            const heartsContainer = document.getElementById('heartsContainer');
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = '❤️';
            heart.style.left = `${Math.random() * 100}%`;
            heart.style.top = `${Math.random() * 100}%`;
            heartsContainer.appendChild(heart);
            
            setTimeout(() => heart.remove(), 1000);
        }

        function usePowerUp(type) {
            if (powerUps[type] <= 0 || gamePaused) return;
            
            powerUps[type]--;
            updatePowerUpDisplay();
            
            switch(type) {
                case 'freeze':
                    useFreezePowerUp();
                    break;
                case 'chance':
                    useSecondChancePowerUp();
                    break;
                case 'peek':
                    useQuickPeekPowerUp();
                    break;
            }
        }

        function useFreezePowerUp() {
            const timerElement = document.getElementById("timer");
            timerElement.style.color = "#00ffff";
            
            // Pause the timer for 10 seconds
            gamePaused = true;
            
            if (freezeTimeoutId) clearTimeout(freezeTimeoutId);
            freezeTimeoutId = setTimeout(() => {
                gamePaused = false;
                timerElement.style.color = "";
            }, 10000);
        }

        function useSecondChancePowerUp() {
            secondChanceActive = true;
            document.getElementById("chancePowerUp").style.border = "2px solid #00ffff";
            setTimeout(() => {
                document.getElementById("chancePowerUp").style.border = "";
            }, 10000);
        }

        function useQuickPeekPowerUp() {
            const unrevealedCards = Array.from(document.querySelectorAll('.card:not(.revealed)'));
            if (unrevealedCards.length === 0) return;
            
            const randomCard = unrevealedCards[Math.floor(Math.random() * unrevealedCards.length)];
            const image = randomCard.dataset.image;
            randomCard.style.backgroundImage = `url(${image})`;
            
            setTimeout(() => {
                if (!randomCard.classList.contains("revealed")) {
                    randomCard.style.backgroundImage = "url('back.jpg')";
                }
            }, 1000);
        }

        function updatePowerUpDisplay() {
            document.getElementById("freezeCount").textContent = `x${powerUps.freeze}`;
            document.getElementById("chanceCount").textContent = `x${powerUps.chance}`;
            document.getElementById("peekCount").textContent = `x${powerUps.peek}`;
            
            // Update disabled state
            document.getElementById("freezePowerUp").classList.toggle("disabled", powerUps.freeze <= 0);
            document.getElementById("chancePowerUp").classList.toggle("disabled", powerUps.chance <= 0);
            document.getElementById("peekPowerUp").classList.toggle("disabled", powerUps.peek <= 0);
        }

        // Add event listener for the Next Level button
        document.getElementById("nextLevelBtn").addEventListener("click", () => {
            document.getElementById("levelCompleteModal").style.display = "none";
            if (currentLevel < 5) {
                currentLevel++;
                // Save updated level
                saveGameState();
                startGame(currentGameMode);
            }
        });

        function changeTheme(themeName) {
            const theme = themes[themeName];
            document.body.style.backgroundColor = theme.background;
            document.body.style.color = theme.text;
            document.querySelectorAll('.card.hidden').forEach(card => {
                card.style.backgroundColor = theme.cardBack;
            });
        }

        function checkAchievements() {
            // Speed Demon achievement
            if (!achievements.speed && timeElapsed < 30) {
                unlockAchievement('speed', 'Speed Demon');
            }
            
            // Perfect Match achievement
            if (!achievements.perfect && mistakesMade === 0) {
                unlockAchievement('perfect', 'Perfect Match');
            }
            
            // Memory Master achievement
            if (!achievements.master && currentLevel === 12) {
                unlockAchievement('master', 'Memory Master');
            }
        }

        function unlockAchievement(id, name) {
            achievements[id] = true;
            
            // Update achievement display
            const achievement = document.getElementById(`achievement-${id}`);
            achievement.classList.add('unlocked');
            
            // Show notification
            const notification = document.createElement('div');
            notification.className = 'achievement-notification';
            notification.innerHTML = `🏆 Achievement Unlocked: ${name}`;
            document.body.appendChild(notification);
            
            // Add notification dot to achievements tab
            document.querySelector('.nav-item:nth-child(2)').classList.add('has-notification');
            
            // Remove notification after 3 seconds
            setTimeout(() => notification.remove(), 3000);
            
            // Save achievements
            localStorage.setItem('achievements', JSON.stringify(achievements));
        }

        function startDailyChallenge(confirmed = false) {
            if (dailyChallengeCompleted) {
                alert("You've already completed today's challenge! Come back tomorrow!");
                return;
            }
            
            if (!confirmed) {
                const modal = document.getElementById('dailyChallengeModal');
                const descElement = document.getElementById('dailyChallengeDesc');
                const rewardsElement = document.getElementById('dailyRewards');
                
                // Generate daily challenge based on date
                const today = new Date();
                const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
                const challengeType = seed % 3;
                
                let description = "";
                switch(challengeType) {
                    case 0:
                        description = "Complete the level with no mistakes!";
                        break;
                    case 1:
                        description = "Complete the level in under 45 seconds!";
                        break;
                    case 2:
                        description = "Complete the level using no power-ups!";
                        break;
                }
                
                descElement.innerHTML = `
                    <p>${description}</p>
                    <p>Difficulty: Level ${Math.min(currentLevel + 2, 10)}</p>
                `;
                
                rewardsElement.innerHTML = `
                    <h3>Rewards:</h3>
                    <p>🎯 50 bonus coins</p>
                    <p>⭐ Double XP</p>
                    ${dailyStreak >= 2 ? `<p>🔥 Streak Bonus: +${dailyStreak * 10} coins</p>` : ''}
                `;
                
                modal.style.display = 'flex';
                return;
            }
            
            isDailyChallenge = true;
            document.getElementById('dailyChallengeModal').style.display = 'none';
            
            // Start game at a slightly higher level than current
            const challengeLevel = Math.min(currentLevel + 2, 10);
            currentLevel = challengeLevel;
            
            startGame('single');
            document.getElementById('streakCounter').style.display = 'block';
        }

        function handleDailyChallengeComplete(success) {
            if (!isDailyChallenge) return;
            
            if (success) {
                dailyChallengeCompleted = true;
                localStorage.setItem('dailyChallengeCompleted', true);
                
                // Update streak
                const today = new Date();
                if (!lastPlayedDate || new Date(lastPlayedDate).toDateString() !== today.toDateString()) {
                    dailyStreak++;
                    localStorage.setItem('dailyStreak', dailyStreak);
                }
                
                // Save last played date
                lastPlayedDate = today;
                localStorage.setItem('lastPlayedDate', lastPlayedDate);
                
                // Award bonus coins
                const streakBonus = dailyStreak >= 2 ? dailyStreak * 10 : 0;
                totalCoins += 50 + streakBonus;
                
                alert(`Daily Challenge Complete! 🎉\nRewards:\n- 50 coins\n- Streak Bonus: ${streakBonus} coins\nCurrent Streak: ${dailyStreak} days`);
            } else {
                alert("Daily Challenge Failed! Try again tomorrow!");
            }
            
            isDailyChallenge = false;
            updateStreakDisplay();
        }

        function updateStreakDisplay() {
            const streakCounter = document.getElementById('streakCounter');
            const streakCount = document.getElementById('streakCount');
            
            if (dailyStreak > 0) {
                streakCounter.style.display = 'block';
                streakCount.textContent = dailyStreak;
            } else {
                streakCounter.style.display = 'none';
            }
        }

        function showLevelSelect(mode) {
            selectedGameMode = mode;
            
            // Hide all sections first
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show level select section
            document.getElementById('levelSelect').style.display = 'block';
            
            const levelGrid = document.getElementById('levelGrid');
            levelGrid.innerHTML = '';
            
            // Updated to show 12 levels instead of 10
            for (let i = 1; i <= 12; i++) {
                const levelCard = document.createElement('div');
                levelCard.className = `level-card ${i > unlockedLevels ? 'locked' : ''}`;
                levelCard.style.animation = `fadeIn 0.3s ease forwards ${i * 0.1}s`;
                levelCard.style.opacity = '0';
                
                const gridSize = getLevelGridSize(i);
                const stars = levelStars[i] || '';
                
                levelCard.innerHTML = `
                    <div class="level-number">${i}</div>
                    <div class="level-stars">${stars}</div>
                    <div class="level-size">${gridSize.rows}x${gridSize.cols}</div>
                `;
                
                if (i <= unlockedLevels) {
                    levelCard.onclick = () => startLevel(i);
                }
                
                levelGrid.appendChild(levelCard);
            }
        }

        function getLevelGridSize(level) {
            const sizes = {
                1: {rows: 4, cols: 3},
                2: {rows: 4, cols: 4},
                3: {rows: 5, cols: 4},
                4: {rows: 5, cols: 5},
                5: {rows: 6, cols: 5},
                6: {rows: 6, cols: 6},
                7: {rows: 7, cols: 6},
                8: {rows: 7, cols: 7},
                9: {rows: 8, cols: 7},
                10: {rows: 8, cols: 8},
                11: {rows: 9, cols: 8},
                12: {rows: 9, cols: 9}
            };
            return sizes[level];
        }

        function startLevel(level) {
            currentLevel = level;
            document.getElementById('levelSelect').style.display = 'none';
            document.getElementById('gameBoard').style.display = 'grid';
            startGame(selectedGameMode);
        }

        function backToLevelSelect() {
            // Stop the timer
            clearInterval(timer);
            
            // Reset game state
            selectedCards = [];
            matchedPairs = 0;
            timeElapsed = 0;
            
            // Hide game elements
            document.getElementById('gameBoard').style.display = 'none';
            document.getElementById('gameControls').style.display = 'none';
            document.getElementById('powerUps').style.display = 'none';
            document.getElementById('timer').style.display = 'none';
            document.getElementById('progress').style.display = 'none';
            document.getElementById('scores').style.display = 'none';
            
            // Show level select
            showLevelSelect(selectedGameMode);
            
            // Pause background music
            backgroundMusic.pause();
        }

        function showSection(section) {
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked nav item
            event.currentTarget.classList.add('active');
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            switch(section) {
                case 'menu':
                    document.getElementById('dashboard').style.display = 'block';
                    updateDashboard();
                    break;
                case 'achievements':
                    document.getElementById('achievementsPanel').style.display = 'block';
                    event.currentTarget.classList.remove('has-notification');
                    break;
                case 'shop':
                    document.getElementById('shopSection').style.display = 'block';
                    updateShopDisplay();
                    event.currentTarget.classList.remove('has-notification');
                    break;
                case 'settings':
                    document.getElementById('settingsSection').style.display = 'block';
                    break;
            }
            
            // If we're leaving a game in progress, handle cleanup
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
        }

        function updateDashboard() {
            // Update level display
            document.getElementById('levelDisplay').textContent = currentLevel;
            
            // Update coins display
            document.getElementById('coinsDisplay').textContent = totalCoins;
            
            // Update achievements count
            const achievementCount = Object.values(achievements).filter(achieved => achieved).length;
            document.getElementById('achievementsDisplay').textContent = achievementCount;
            
            // Update streak display
            document.getElementById('streakDisplay').textContent = dailyStreak;
            
            // Update recent achievements
            const recentAchievementsDiv = document.getElementById('recentAchievements');
            recentAchievementsDiv.innerHTML = '';
            
            Object.entries(achievements).forEach(([id, achieved]) => {
                if (achieved) {
                    const achievementName = {
                        'speed': 'Speed Demon',
                        'perfect': 'Perfect Match',
                        'master': 'Memory Master'
                    }[id];
                    
                    const achievementElement = document.createElement('div');
                    achievementElement.className = 'recent-achievement-item';
                    achievementElement.innerHTML = `
                        <div class="achievement-icon">🏆</div>
                        <div>${achievementName}</div>
                    `;
                    recentAchievementsDiv.appendChild(achievementElement);
                }
            });
            
            // If no achievements yet, show a message
            if (recentAchievementsDiv.children.length === 0) {
                recentAchievementsDiv.innerHTML = `
                    <div class="recent-achievement-item">
                        <div>No achievements yet. Keep playing to earn some!</div>
                    </div>
                `;
            }

            // Update quick actions section
            const quickActions = document.querySelector('.quick-actions');
            quickActions.innerHTML = `
                <div class="action-button play-game" onclick="showGameModeSelection()">
                    <div class="button-content">
                        <div class="play-icon-container">
                            <i class="fa-solid fa-play play-icon"></i>
                        </div>
                        <div class="button-text">Play Game</div>
                        <div class="button-subtext">Level ${currentLevel}</div>
                    </div>
                </div>
                <div class="action-button" onclick="startDailyChallenge()">
                    <div class="action-icon">🎯</div>
                    <div>Daily Challenge</div>
                </div>
                <div class="action-button" onclick="showSection('achievements')">
                    <div class="action-icon">🏆</div>
                    <div>Achievements</div>
                </div>
                <div class="action-button" onclick="showSection('shop')">
                    <div class="action-icon">🛍️</div>
                    <div>Shop</div>
                </div>
            `;

            // Add ripple effect to play button
            const playButton = document.querySelector('.action-button.play-game');
            playButton.addEventListener('click', createRipple);
        }

        function createRipple(event) {
            const button = event.currentTarget;
            const ripple = document.createElement('span');
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.width = ripple.style.height = `${size}px`;
            ripple.style.left = `${x}px`;
            ripple.style.top = `${y}px`;
            ripple.className = 'ripple';
            
            button.appendChild(ripple);
            
            ripple.addEventListener('animationend', () => {
                ripple.remove();
            });
        }

        function showGameModeSelection() {
            const modal = document.getElementById('gameModeModal');
            modal.style.display = 'flex';
            
            // Add click outside to close
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        function startGameMode(mode) {
            const modal = document.getElementById('gameModeModal');
            modal.style.display = 'none';
            showLevelSelect(mode);
        }

        // Modify showLevelSelect to handle the transition better
        function showLevelSelect(mode) {
            selectedGameMode = mode;
            
            // Hide all sections first
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show level select section
            document.getElementById('levelSelect').style.display = 'block';
            
            const levelGrid = document.getElementById('levelGrid');
            levelGrid.innerHTML = '';
            
            // Add a nice animation to the level cards as they appear
            for (let i = 1; i <= 12; i++) {
                const levelCard = document.createElement('div');
                levelCard.className = `level-card ${i > unlockedLevels ? 'locked' : ''}`;
                levelCard.style.animation = `fadeIn 0.3s ease forwards ${i * 0.1}s`;
                levelCard.style.opacity = '0';
                
                const gridSize = getLevelGridSize(i);
                const stars = levelStars[i] || '';
                
                levelCard.innerHTML = `
                    <div class="level-number">${i}</div>
                    <div class="level-stars">${stars}</div>
                    <div class="level-size">${gridSize.rows}x${gridSize.cols}</div>
                `;
                
                if (i <= unlockedLevels) {
                    levelCard.onclick = () => startLevel(i);
                }
                
                levelGrid.appendChild(levelCard);
            }
        }

        // Add new animation keyframe
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(style);

        // Add new shop-related functions
        function buyItem(type, cost, amount) {
            if (totalCoins >= cost) {
                totalCoins -= cost;
                
                switch(type) {
                    case 'hint':
                        hintsLeft += amount;
                        document.getElementById('hintBtn').innerText = `Hint (${hintsLeft})`;
                        break;
                    case 'freeze':
                        powerUps.freeze += amount;
                        break;
                    case 'chance':
                        powerUps.chance += amount;
                        break;
                    case 'peek':
                        powerUps.peek += amount;
                        break;
                }
                
                updatePowerUpDisplay();
                updateShopDisplay();
                saveGameState();
                alert(`Successfully purchased ${amount} ${type} power-ups!`);
            } else {
                alert('Not enough coins! Complete more levels to earn coins.');
            }
        }

        function buyBundle() {
            if (totalCoins >= 100) {
                totalCoins -= 100;
                hintsLeft += 3;
                powerUps.freeze += 3;
                powerUps.chance += 3;
                powerUps.peek += 3;
                
                updatePowerUpDisplay();
                updateShopDisplay();
                saveGameState();
                alert('Successfully purchased Premium Bundle!');
            } else {
                alert('Not enough coins! Complete more levels to earn coins.');
            }
        }

        function updateShopDisplay() {
            document.getElementById('shopCoinsDisplay').textContent = totalCoins;
            
            // Update buy buttons based on available coins
            document.querySelectorAll('.shop-item').forEach(item => {
                const button = item.querySelector('.buy-button');
                const priceText = item.querySelector('.item-price').textContent;
                const price = parseInt(priceText);
                button.disabled = totalCoins < price;
            });
        }

        // Add new variables for settings
        let gameSettings = {
            difficulty: 'normal',
            extendedTime: false,
            musicVolume: 50,
            sfxVolume: 70,
            visualEffects: true,
            theme: 'default'
        };

        // Add new achievement tracking
        let achievementProgress = {
            speed: 0,      // Best time in seconds
            perfect: 0,    // Perfect games count
            master: 1,     // Current level (out of 12)
            streak: 0,     // Current streak
            collector: 0   // 3-star levels count
        };

        function updateAchievementProgress() {
            // Update progress bars
            document.getElementById('speedProgress').style.width = 
                `${Math.min((30 - achievementProgress.speed) / 30 * 100, 100)}%`;
            document.getElementById('perfectProgress').style.width = 
                `${(achievementProgress.perfect / 3) * 100}%`;
            document.getElementById('masterProgress').style.width = 
                `${(achievementProgress.master / 12) * 100}%`;  // Changed from 10 to 12
            document.getElementById('streakProgress').style.width = 
                `${(achievementProgress.streak / 7) * 100}%`;
            document.getElementById('collectorProgress').style.width = 
                `${(achievementProgress.collector / 5) * 100}%`;
            
            // Update unlocked state
            document.querySelectorAll('.achievement-card').forEach(card => {
                if (card.id === 'achievement-speed' && achievementProgress.speed <= 30) {
                    card.classList.add('unlocked');
                }
                if (card.id === 'achievement-perfect' && achievementProgress.perfect >= 3) {
                    card.classList.add('unlocked');
                }
                if (card.id === 'achievement-master' && achievementProgress.master >= 12) {  // Changed from 10 to 12
                    card.classList.add('unlocked');
                }
                if (card.id === 'achievement-streak' && achievementProgress.streak >= 7) {
                    card.classList.add('unlocked');
                }
                if (card.id === 'achievement-collector' && achievementProgress.collector >= 5) {
                    card.classList.add('unlocked');
                }
            });
        }

        function changeDifficulty(value) {
            gameSettings.difficulty = value;
            updateTimeLimits();
            saveSettings();
            
            // Show feedback toast
            showSettingsFeedback(`Difficulty changed to ${value}`);
        }

        function updateTimeLimits() {
            // Reset to default first
            Object.assign(maxTimeLimits, defaultTimeLimits);
            
            // Apply difficulty modifications
            switch(gameSettings.difficulty) {
                case 'easy':
                    Object.keys(maxTimeLimits).forEach(level => {
                        maxTimeLimits[level] += 20;
                    });
                    break;
                case 'hard':
                    Object.keys(maxTimeLimits).forEach(level => {
                        maxTimeLimits[level] -= 15;
                    });
                    break;
            }
            
            // Apply extended time if enabled
            if (gameSettings.extendedTime) {
                Object.keys(maxTimeLimits).forEach(level => {
                    maxTimeLimits[level] += 30;
                });
            }
        }

        function toggleExtendedTime(enabled) {
            gameSettings.extendedTime = enabled;
            updateTimeLimits();
            saveSettings();
            
            // Show feedback toast
            showSettingsFeedback(`Extended time mode ${enabled ? 'enabled' : 'disabled'}`);
        }

        function adjustVolume(type, value) {
            const numValue = parseInt(value);
            if (type === 'music') {
                gameSettings.musicVolume = numValue;
                if (backgroundMusic) {
                    backgroundMusic.volume = numValue / 100;
                }
            } else {
                gameSettings.sfxVolume = numValue;
                [flipSound, matchSound, winSound, errorSound].forEach(sound => {
                    if (sound) sound.volume = numValue / 100;
                });
            }
            saveSettings();
            
            // Show feedback toast
            showSettingsFeedback(`${type === 'music' ? 'Music' : 'Sound effects'} volume: ${numValue}%`);
        }

        function toggleEffects(enabled) {
            gameSettings.visualEffects = enabled;
            saveSettings();
            
            // Show feedback toast
            showSettingsFeedback(`Visual effects ${enabled ? 'enabled' : 'disabled'}`);
            
            // Apply effects change immediately
            document.querySelectorAll('.card, .achievement-card, .action-button').forEach(element => {
                element.style.transition = enabled ? 'all 0.3s ease' : 'none';
            });
        }

        function changeTheme(themeName) {
            gameSettings.theme = themeName;
            const theme = themes[themeName];
            
            document.body.style.backgroundColor = theme.background;
            document.body.style.color = theme.text;
            
            // Update card backgrounds
            document.querySelectorAll('.card.hidden').forEach(card => {
                card.style.backgroundColor = theme.cardBack;
            });
            
            // Update modal backgrounds
            document.querySelectorAll('.modal-content').forEach(modal => {
                modal.style.backgroundColor = theme.cardBack;
            });
            
            saveSettings();
            
            // Show feedback toast
            showSettingsFeedback(`Theme changed to ${themeName}`);
        }

        function saveSettings() {
            localStorage.setItem('gameSettings', JSON.stringify(gameSettings));
        }

        // Add a toast notification system for settings changes
        function showSettingsFeedback(message) {
            const toast = document.createElement('div');
            toast.className = 'settings-toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Remove toast after animation
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Add toast styling
        const toastStyle = document.createElement('style');
        toastStyle.textContent = `
            .settings-toast {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #daff0a;
                color: #1a202c;
                padding: 12px 24px;
                border-radius: 20px;
                font-weight: bold;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: toastIn 0.3s ease forwards, toastOut 0.3s ease forwards 2.7s;
            }
            
            @keyframes toastIn {
                from {
                    transform: translate(-50%, 100%);
                    opacity: 0;
                }
                to {
                    transform: translate(-50%, 0);
                    opacity: 1;
                }
            }
            
            @keyframes toastOut {
                from {
                    transform: translate(-50%, 0);
                    opacity: 1;
                }
                to {
                    transform: translate(-50%, 100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(toastStyle);

        // Initialize settings when the page loads
        window.addEventListener('load', initializeSettings);

        // Modify the existing window.onload to work with the new initialization
        const existingOnload = window.onload;
        window.onload = function() {
            if (existingOnload) existingOnload();
            initializeSettings();
        };

        // Add daily rewards system
        const dailyRewards = {
            1: 50,    // Day 1: 50 coins
            2: 75,    // Day 2: 75 coins
            3: 100,   // Day 3: 100 coins
            4: 150,   // Day 4: 150 coins
            5: 200,   // Day 5: 200 coins
            6: 250,   // Day 6: 250 coins
            7: 500    // Day 7: 500 coins (Weekly bonus)
        };

        let lastClaimDate = localStorage.getItem('lastClaimDate');
        let currentLoginStreak = parseInt(localStorage.getItem('loginStreak')) || 0;
        let claimedToday = false;

        function checkDailyRewards() {
            const today = new Date().toDateString();
            const lastDate = lastClaimDate ? new Date(lastClaimDate).toDateString() : null;
            
            if (!lastDate) {
                // First time user
                showDailyRewardsModal();
            } else if (today !== lastDate) {
                // Check if streak should be reset (more than 1 day gap)
                const daysSinceLastClaim = Math.floor((new Date() - new Date(lastClaimDate)) / (1000 * 60 * 60 * 24));
                if (daysSinceLastClaim > 1) {
                    currentLoginStreak = 0;
                    localStorage.setItem('loginStreak', currentLoginStreak);
                }
                showDailyRewardsModal();
            }
            
            updateDailyRewardsDisplay();
        }

        function showDailyRewardsModal() {
            const modal = document.getElementById('dailyRewardsModal');
            modal.style.display = 'flex';
            
            // Update streak display
            document.getElementById('currentStreak').textContent = currentLoginStreak;
            
            // Populate rewards grid
            const rewardsGrid = document.getElementById('rewardsGrid');
            rewardsGrid.innerHTML = '';
            
            for (let day = 1; day <= 7; day++) {
                const reward = dailyRewards[day];
                const dayElement = document.createElement('div');
                dayElement.className = `reward-day${day === currentLoginStreak + 1 ? ' current' : ''}${day <= currentLoginStreak ? ' claimed' : ''}`;
                dayElement.innerHTML = `
                    <div class="day-number">Day ${day}</div>
                    <div class="reward-icon">💰</div>
                    <div class="reward-amount">${reward}</div>
                `;
                rewardsGrid.appendChild(dayElement);
            }
            
            // Update claim button state
            const claimButton = document.getElementById('claimRewardBtn');
            claimButton.disabled = claimedToday;
            claimButton.textContent = claimedToday ? 'Come back tomorrow!' : 'Claim Reward';
        }

        function claimDailyReward() {
            const today = new Date().toDateString();
            
            if (claimedToday || (lastClaimDate && today === new Date(lastClaimDate).toDateString())) {
                return;
            }
            
            // Increment streak and save date
            currentLoginStreak = (currentLoginStreak % 7) + 1;
            lastClaimDate = new Date().toTime();
            claimedToday = true;
            
            // Award coins
            const reward = dailyRewards[currentLoginStreak];
            totalCoins += reward;
            
            // Save to localStorage
            localStorage.setItem('lastClaimDate', lastClaimDate);
            localStorage.setItem('loginStreak', currentLoginStreak);
            localStorage.setItem('totalCoins', totalCoins);
            
            // Show reward animation
            showRewardAnimation(reward);
            
            // Update displays
            updateProgress();
            updateDailyRewardsDisplay();
            
            // Close modal after animation
            setTimeout(() => {
                document.getElementById('dailyRewardsModal').style.display = 'none';
            }, 2000);
        }

        function showRewardAnimation(amount) {
            const rewardText = document.createElement('div');
            rewardText.className = 'reward-animation';
            rewardText.textContent = `+${amount} 💰`;
            document.body.appendChild(rewardText);
            
            setTimeout(() => rewardText.remove(), 2000);
        }

        // Add reward animation style
        const rewardStyle = document.createElement('style');
        rewardStyle.textContent = `
            .reward-animation {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 32px;
                color: #daff0a;
                font-weight: bold;
                animation: floatUp 2s ease-out forwards;
                z-index: 1001;
            }
            @keyframes floatUp {
                0% {
                    transform: translate(-50%, -50%) scale(1);
                    opacity: 1;
                }
                100% {
                    transform: translate(-50%, -200%) scale(1.5);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(rewardStyle);

        // Call checkDailyRewards when the game loads
        window.addEventListener('load', () => {
            checkDailyRewards();
            loadProfile(); // Load profile on startup
        });

        // Developer Mode Functions
        function showDeveloperPanel() {
            document.getElementById('developerModal').style.display = 'flex';
        }

        function addCoins(amount) {
            totalCoins += amount;
            localStorage.setItem('totalCoins', totalCoins);
            updateProgress();
            logDebug(`Added ${amount} coins. New total: ${totalCoins}`);
        }

        function unlockAllLevels() {
            unlockedLevels = 12;
            localStorage.setItem('unlockedLevels', unlockedLevels);
            
            // Add 3 stars to all levels
            for (let i = 1; i <= 12; i++) {
                levelStars[i] = '★★★';
            }
            localStorage.setItem('levelStars', JSON.stringify(levelStars));
            
            logDebug('All levels unlocked with 3 stars');
            alert('All levels unlocked!');
        }

        function unlockAllAchievements() {
            const achievementIds = ['speed', 'perfect', 'master', 'streak', 'collector'];
            achievementIds.forEach(id => {
                achievements[id] = true;
                document.getElementById(`achievement-${id}`).classList.add('unlocked');
            });
            
            localStorage.setItem('achievements', JSON.stringify(achievements));
            logDebug('All achievements unlocked');
            alert('All achievements unlocked!');
        }

        function resetAllProgress() {
            if (confirm('Are you sure you want to reset ALL progress? This cannot be undone!')) {
                localStorage.clear();
                logDebug('All progress reset');
                location.reload();
            }
        }

        let debugLogsEnabled = false;
        function toggleDebugLogs(enabled) {
            debugLogsEnabled = enabled;
            let logsDiv = document.getElementById('debugLogs');
            
            if (!logsDiv) {
                logsDiv = document.createElement('div');
                logsDiv.id = 'debugLogs';
                document.body.appendChild(logsDiv);
            }
            
            logsDiv.style.display = enabled ? 'block' : 'none';
            logDebug('Debug logs ' + (enabled ? 'enabled' : 'disabled'));
        }

        function logDebug(message) {
            if (!debugLogsEnabled) return;
            
            const logsDiv = document.getElementById('debugLogs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${timestamp}] ${message}`;
            logsDiv.appendChild(logEntry);
            
            // Keep only last 50 messages
            while (logsDiv.children.length > 50) {
                logsDiv.removeChild(logsDiv.firstChild);
            }
            
            // Auto-scroll to bottom
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        // Developer mode variables - REMOVED (now using devTools object)
        // let tapCount = 0;
        // let lastTapTime = 0;
        // let isDeveloperMode = false;

        // Add tap detection to header with visual feedback
        /*document.querySelector('.header').addEventListener('click', (e) => {
            const currentTime = new Date().getTime();
            const tapGap = currentTime - lastTapTime;
            
            if (tapGap < 500) {
                tapCount++;
                
                const header = document.querySelector('.header');
                header.style.backgroundColor = `rgba(${45 + (tapCount * 10)}, 55, 72, 1)`;
                
                if (tapCount === 5) {
                    toggleDeveloperMode();
                    tapCount = 0;
                    header.style.backgroundColor = '#2d3748';
                }
            } else {
                tapCount = 1;
            }
            lastTapTime = currentTime;
            
            if (tapCount > 0) {
                showTapFeedback(tapCount);
            }
        });*/

        // Developer mode variables - REMOVED (now using devTools object)
        // let isDeveloperMode = false;
        // const DEVELOPER_PASSWORD = "Possigee.1";

        // Add achievement tracking
    </script>

    <!-- Add this new modal after other modals -->
    <div id="dailyRewardsModal" class="daily-rewards-modal">
        <div class="daily-rewards-content">
            <h2 class="rewards-title">Daily Rewards</h2>
            <div class="streak-info">
                <span class="streak-flame">🔥</span>
                <span>Current Streak: <span id="currentStreak">0</span> days</span>
            </div>
            <div class="rewards-grid" id="rewardsGrid">
                <!-- Rewards will be populated by JavaScript -->
            </div>
            <button id="claimRewardBtn" class="claim-button" onclick="claimDailyReward()">
                Claim Reward
            </button>
        </div>
    </div>

    <!-- Developer Mode Modal -->
    <div id="developerModal" class="modal">
        <div class="modal-content">
            <h2 style="color: #ff0000;">🛠️ Developer Mode</h2>
            <div class="developer-tools">
                <button onclick="devTools.addCoins(9999999)" class="dev-button">
                    <i class="fa-solid fa-coins"></i> Add 9,999,999 Coins
                </button>
                <button onclick="devTools.unlockAllLevels()" class="dev-button">
                    <i class="fa-solid fa-unlock"></i> Unlock All Levels
                </button>
                <button onclick="devTools.unlockAllAchievements()" class="dev-button">
                    <i class="fa-solid fa-trophy"></i> Unlock All Achievements
                </button>
                <button onclick="devTools.resetAllProgress()" class="dev-button danger">
                    <i class="fa-solid fa-trash"></i> Reset All Progress
                </button>
            </div>
            <button onclick="document.getElementById('developerModal').style.display='none'" class="dev-close">
                Close
            </button>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close-btn" onclick="document.getElementById('profileModal').style.display='none'">×</button>
            <h2>Your Profile 👤</h2>
            <div class="profile-form">
                <div class="profile-avatar-section">
                    <div class="current-avatar" id="selectedAvatar">
                        <img src="https://api.dicebear.com/6.x/fun-emoji/svg?seed=default" alt="Avatar">
                    </div>
                    <button onclick="generateNewAvatar()" class="profile-button">
                        <i class="fa-solid fa-dice"></i> New Avatar
                    </button>
                </div>
                <div class="profile-input-group">
                    <label for="profileName">Your Name</label>
                    <input type="text" id="profileName" placeholder="Enter your name" maxlength="20">
                </div>
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-label">Total Games</div>
                        <div class="stat-value" id="totalGames">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Best Time</div>
                        <div class="stat-value" id="bestTime">--</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total Stars</div>
                        <div class="stat-value" id="totalStars">0</div>
                    </div>
                </div>
                <button onclick="saveProfile()" class="profile-button save">
                    <i class="fa-solid fa-save"></i> Save Profile
                </button>
            </div>
        </div>
    </div>

    <script>
        // Profile System
        let userProfile = {
            name: '',
            avatarSeed: 'default',
            totalGames: 0,
            bestTime: null,
            totalStars: 0,
            lastUpdated: new Date().toISOString()
        };

        function loadProfile() {
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                userProfile = JSON.parse(savedProfile);
                updateProfileDisplay();
            }
        }

        function showProfile() {
            const profileModal = document.getElementById('profileModal');
            const nameInput = document.getElementById('profileName');
            
            profileModal.style.display = 'flex';
            nameInput.value = userProfile.name;
            updateProfileStats();
        }

        function generateNewAvatar() {
            const seeds = ['happy', 'smile', 'joy', 'fun', 'cool', 'sweet', 'cute', 'nice', 'kind', 'warm'];
            const randomSeed = seeds[Math.floor(Math.random() * seeds.length)] + Date.now();
            userProfile.avatarSeed = randomSeed;
            
            const avatarUrl = `https://api.dicebear.com/6.x/fun-emoji/svg?seed=${randomSeed}`;
            document.getElementById('selectedAvatar').querySelector('img').src = avatarUrl;
            document.getElementById('profileTrigger').querySelector('img').src = avatarUrl;
        }

        function saveProfile() {
            const nameInput = document.getElementById('profileName');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Please enter your name!');
                return;
            }
            
            userProfile.name = name;
            userProfile.lastUpdated = new Date().toISOString();
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            updateProfileDisplay();
            document.getElementById('profileModal').style.display = 'none';
            
            showToast(`Profile saved, ${userProfile.name}! 👋`);
        }

        function updateProfileDisplay() {
            const avatarUrl = `https://api.dicebear.com/6.x/fun-emoji/svg?seed=${userProfile.avatarSeed}`;
            document.getElementById('selectedAvatar').querySelector('img').src = avatarUrl;
            document.getElementById('profileTrigger').querySelector('img').src = avatarUrl;
            
            // Update name input if it exists
            const nameInput = document.getElementById('profileName');
            if (nameInput) {
                nameInput.value = userProfile.name || '';
            }
            
            updateProfileStats();
        }

        function updateProfileStats() {
            // Update display in profile modal
            document.getElementById('totalGames').textContent = userProfile.totalGames || 0;
            document.getElementById('bestTime').textContent = userProfile.bestTime ? `${userProfile.bestTime}s` : '--';
            document.getElementById('totalStars').textContent = userProfile.totalStars || 0;
            
            // Calculate total stars from level stars
            let totalStarsFromLevels = 0;
            Object.values(levelStars).forEach(stars => {
                totalStarsFromLevels += (stars.match(/★/g) || []).length;
            });
            
            // Update total stars if there's a discrepancy
            if (totalStarsFromLevels !== userProfile.totalStars) {
                userProfile.totalStars = totalStarsFromLevels;
                localStorage.setItem('userProfile', JSON.stringify(userProfile));
            }
        }

        // Initialize profile system
        window.addEventListener('DOMContentLoaded', () => {
            loadProfile();
            
            // Close modal when clicking outside
            const profileModal = document.getElementById('profileModal');
            profileModal.addEventListener('click', (e) => {
                if (e.target === profileModal) {
                    profileModal.style.display = 'none';
                }
            });

            // Check developer mode state
            if (localStorage.getItem('devMode') === 'true') {
                isDeveloperMode = true;
                document.querySelector('.dev-mode-btn').textContent = 'Disable';
            }
        });

        function updateGameStats(gameTime, starsEarned) {
            userProfile.totalGames++;
            userProfile.totalStars += parseInt(starsEarned);
            
            if (!userProfile.bestTime || gameTime < userProfile.bestTime) {
                userProfile.bestTime = gameTime;
            }
            
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            updateProfileStats();
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Add styles
        const profileStyles = document.createElement('style');
        profileStyles.textContent = `
            .modal-close-btn {
                position: absolute;
                top: 10px;
                right: 10px;
                background: none;
                border: none;
                color: #a0aec0;
                font-size: 24px;
                cursor: pointer;
                padding: 5px 10px;
                border-radius: 5px;
                transition: all 0.3s ease;
            }
            .modal-close-btn:hover {
                color: white;
                background: rgba(255,255,255,0.1);
            }
            .toast-notification {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #daff0a;
                color: #1a202c;
                padding: 12px 24px;
                border-radius: 25px;
                font-weight: bold;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: toastIn 0.3s ease forwards, toastOut 0.3s ease forwards 2.7s;
            }
            @keyframes toastIn {
                from {
                    transform: translate(-50%, 100%);
                    opacity: 0;
                }
                to {
                    transform: translate(-50%, 0);
                    opacity: 1;
                }
            }
            @keyframes toastOut {
                from {
                    transform: translate(-50%, 0);
                    opacity: 1;
                }
                to {
                    transform: translate(-50%, 100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(profileStyles);

        // Developer mode variables - REMOVED (now using devTools object)
        // let isDeveloperMode = false;
        // const DEVELOPER_PASSWORD = "Possigee.1";

        // Add achievement tracking
    </script>

    <!-- Audio Settings Functions -->
    function toggleBGM(enabled) {
        localStorage.setItem('bgmEnabled', enabled);
        if (enabled) {
            if (bgMusic && !bgMusic.playing()) {
                bgMusic.play();
            }
            showToast('Background Music Enabled');
        } else {
            if (bgMusic && bgMusic.playing()) {
                bgMusic.pause();
            }
            showToast('Background Music Disabled');
        }
    }

    function toggleSFX(enabled) {
        localStorage.setItem('sfxEnabled', enabled);
        sfxEnabled = enabled;
        showToast(`Sound Effects ${enabled ? 'Enabled' : 'Disabled'}`);
    }

    // Initialize audio settings on page load
    window.addEventListener('DOMContentLoaded', () => {
        const bgmEnabled = localStorage.getItem('bgmEnabled') !== 'false';
        const sfxEnabled = localStorage.getItem('sfxEnabled') !== 'false';
        
        document.getElementById('bgmToggle').checked = bgmEnabled;
        document.getElementById('sfxToggle').checked = sfxEnabled;
        
        if (!bgmEnabled && bgMusic && bgMusic.playing()) {
            bgMusic.pause();
        }
    });

    // Theme Management
    function changeTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        
        // Update theme preview active state
        document.querySelectorAll('.theme-preview').forEach(preview => {
            preview.classList.remove('active');
        });
        document.querySelector(`.theme-preview.${theme}`).classList.add('active');
        
        showToast(`${theme.charAt(0).toUpperCase() + theme.slice(1)} theme applied`);
    }

    // Initialize theme
    window.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('theme') || 'default';
        changeTheme(savedTheme);
    });
</body>
</html>